---
title: 弹窗
date: 2017-08-29 17:16:15
toc: true
comments: true
tags:
  - android
---

## 弹出和隐藏进度条

```java
private Dialog dialog;

private void showDialog(final Context ctx) {
    if (ctx instanceof Activity) {
        final Activity context = (Activity) ctx;
        context.runOnUiThread(new Runnable() {
            @Override
            public void run() {
                int spacing = Uscreen.dp2Px(context, 16);
                LinearLayout layout = new LinearLayout(context);
                LinearLayout.LayoutParams layoutParams = new LinearLayout.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT);
                layout.setLayoutParams(layoutParams);
                layout.setGravity(Gravity.CENTER);
                layout.setPadding(spacing, spacing, spacing, spacing);
                // add ProgressBar
                ProgressBar bar = new ProgressBar(context);
                layout.addView(bar, layoutParams);

                dialog = new Dialog(context, android.R.style.Theme_Holo_Dialog_NoActionBar);
                dialog.setCancelable(false);
                dialog.getWindow().setDimAmount(0.3f);
                dialog.setContentView(layout);
                dialog.show();
            }
        });
    }

}

private void dismissDialog() {
    if (dialog != null && dialog.isShowing()) {
        dialog.dismiss();
    }
}

```

## 单个操作的 alert

```java
public static void alert(Context context, String message, Consumer<Boolean> consumer) {
    new AlertDialog.Builder(context)
            .setMessage(message)
            .setPositiveButton("是的", (dialog, which) -> {
                consumer.accept(true);
            })
            .setNegativeButton("再想想", (dialog, which) -> {
                consumer.accept(false);
            })
            .setCancelable(true)
            .create()
            .show();
}
```

## 多个操作的 alert

```java
enum OperateType {
    REFRESH("刷新"),
    COPY_LINK("复制链接"),
    COPY_MD_LINK("复制md链接"),
    OPEN_WITH_BROWSER("在浏览器中打开"),
    ;
    String title;

    OperateType(String title) {
        this.title = title;
    }

    public static OperateType indexOf(int index) {
        return OperateType.values()[index];
    }

    public static String[] toStrArray() {
        OperateType[] values = OperateType.values();
        String[] result = new String[values.length];
        for (int i = 0; i < values.length; i++) {
            result[i] = values[i].title;
        }
        return result;
    }
}

private void onMorePressed() {
    new AlertDialog.Builder(mContext)
            .setTitle("操作")
            .setItems(OperateType.toStrArray(), (dialog, which) -> {
                switch (OperateType.indexOf(which)) {
                    case REFRESH:
                        mWvContent.reload();
                        break;
                    case COPY_LINK:
                        copyToClipboard(mWvContent.getUrl(), "已复制到剪切板");
                        break;
                    case COPY_MD_LINK:
                        String title = mWvContent.getTitle();
                        String url = mWvContent.getUrl();
                        copyToClipboard("- [" + title + "]" + "(" + url + ")", "已复制到剪切板");
                        break;
                    case OPEN_WITH_BROWSER:
                        Uri uri = Uri.parse(mWvContent.getUrl());
                        Intent intent = new Intent(Intent.ACTION_VIEW, uri);
                        startActivity(intent);
                        break;
                    default:
                }
            })
            .create().show();
}

```
