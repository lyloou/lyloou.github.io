<!DOCTYPE html>
<html lang="zh-CN,zh-HK,zh-TW,en,default">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"lyloou.github.io","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"default"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":{"gitalk":{"order":-2}}},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="JustAuth ç®€ä»‹ ğŸ†Gitee æœ€æœ‰ä»·å€¼å¼€æºé¡¹ç›® ğŸš€ğŸ’¯ å°è€Œå…¨è€Œç¾çš„ç¬¬ä¸‰æ–¹ç™»å½•å¼€æºç»„ä»¶ã€‚ç›®å‰å·²æ”¯æŒ Githubã€Giteeã€å¾®åšã€é’‰é’‰ã€ç™¾åº¦ã€Codingã€è…¾è®¯äº‘å¼€å‘è€…å¹³å°ã€OSChinaã€æ”¯ä»˜å®ã€QQã€å¾®ä¿¡ã€æ·˜å®ã€Googleã€Facebookã€æŠ–éŸ³ã€é¢†è‹±ã€å°ç±³ã€å¾®è½¯ã€ä»Šæ—¥å¤´æ¡ã€Teambitionã€StackOverflowã€Pinterestã€äººäººã€åä¸ºã€ä¼ä¸šå¾®ä¿¡ã€é…·å®¶ä¹ã€Gi">
<meta property="og:type" content="article">
<meta property="og:title" content="Justauthæºç å­¦ä¹ ">
<meta property="og:url" content="https://lyloou.github.io/%E8%AF%BB%E6%BA%90%E7%A0%81/justauth%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0/index.html">
<meta property="og:site_name" content="lyloou">
<meta property="og:description" content="JustAuth ç®€ä»‹ ğŸ†Gitee æœ€æœ‰ä»·å€¼å¼€æºé¡¹ç›® ğŸš€ğŸ’¯ å°è€Œå…¨è€Œç¾çš„ç¬¬ä¸‰æ–¹ç™»å½•å¼€æºç»„ä»¶ã€‚ç›®å‰å·²æ”¯æŒ Githubã€Giteeã€å¾®åšã€é’‰é’‰ã€ç™¾åº¦ã€Codingã€è…¾è®¯äº‘å¼€å‘è€…å¹³å°ã€OSChinaã€æ”¯ä»˜å®ã€QQã€å¾®ä¿¡ã€æ·˜å®ã€Googleã€Facebookã€æŠ–éŸ³ã€é¢†è‹±ã€å°ç±³ã€å¾®è½¯ã€ä»Šæ—¥å¤´æ¡ã€Teambitionã€StackOverflowã€Pinterestã€äººäººã€åä¸ºã€ä¼ä¸šå¾®ä¿¡ã€é…·å®¶ä¹ã€Gi">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://cdn.lyloou.com/img/justauth%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0-2021-06-29-17-22-17.png">
<meta property="og:image" content="http://cdn.lyloou.com/img/justauth%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0-2021-06-29-17-10-59.png">
<meta property="og:image" content="https://raw.githubusercontent.com/lyloou/img/develop/justauth%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0-2021-07-02-10-50-48.png">
<meta property="og:image" content="http://cdn.lyloou.com/img/20210625112103.png">
<meta property="article:published_time" content="2021-06-25T02:44:54.000Z">
<meta property="article:modified_time" content="2021-06-25T02:44:54.000Z">
<meta property="article:author" content="lyloou">
<meta property="article:tag" content="java">
<meta property="article:tag" content="æºç ">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://cdn.lyloou.com/img/justauth%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0-2021-06-29-17-22-17.png">

<link rel="canonical" href="https://lyloou.github.io/%E8%AF%BB%E6%BA%90%E7%A0%81/justauth%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Justauthæºç å­¦ä¹  | lyloou</title>
  
    <script>
      function sendPageView() {
        if (CONFIG.hostname !== location.hostname) return;
        var uid = localStorage.getItem('uid') || (Math.random() + '.' + Math.random());
        localStorage.setItem('uid', uid);
        navigator.sendBeacon('https://www.google-analytics.com/collect', new URLSearchParams({
          v  : 1,
          tid: 'UA-80542932-1',
          cid: uid,
          t  : 'pageview',
          dp : encodeURIComponent(location.pathname)
        }));
      }
      document.addEventListener('pjax:complete', sendPageView);
      sendPageView();
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta custom-logo">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">lyloou</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>å½’æ¡£</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://lyloou.github.io/%E8%AF%BB%E6%BA%90%E7%A0%81/justauth%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/assets/images/avatar.png">
      <meta itemprop="name" content="lyloou">
      <meta itemprop="description" content="/* Better than last best */">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lyloou">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Justauthæºç å­¦ä¹ <a href="https://github.com/lyloou/lyloou.github.io/edit/source/source/_posts/%E8%AF%BB%E6%BA%90%E7%A0%81/justauth%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0.md" class="post-edit-link" title="ç¼–è¾‘" rel="noopener" target="_blank"><i class="fa fa-pencil-alt"></i></a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-06-25 10:44:54" itemprop="dateCreated datePublished" datetime="2021-06-25T10:44:54+08:00">2021-06-25</time>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="JustAuth-ç®€ä»‹"><a href="#JustAuth-ç®€ä»‹" class="headerlink" title="JustAuth ç®€ä»‹"></a>JustAuth ç®€ä»‹</h2><blockquote>
<p>ğŸ†Gitee æœ€æœ‰ä»·å€¼å¼€æºé¡¹ç›® ğŸš€ğŸ’¯ å°è€Œå…¨è€Œç¾çš„ç¬¬ä¸‰æ–¹ç™»å½•å¼€æºç»„ä»¶ã€‚ç›®å‰å·²æ”¯æŒ Githubã€Giteeã€å¾®åšã€é’‰é’‰ã€ç™¾åº¦ã€Codingã€è…¾è®¯äº‘å¼€å‘è€…å¹³å°ã€OSChinaã€æ”¯ä»˜å®ã€QQã€å¾®ä¿¡ã€æ·˜å®ã€Googleã€Facebookã€æŠ–éŸ³ã€é¢†è‹±ã€å°ç±³ã€å¾®è½¯ã€ä»Šæ—¥å¤´æ¡ã€Teambitionã€StackOverflowã€Pinterestã€äººäººã€åä¸ºã€ä¼ä¸šå¾®ä¿¡ã€é…·å®¶ä¹ã€Gitlabã€ç¾å›¢ã€é¥¿äº†ä¹ˆã€æ¨ç‰¹ã€é£ä¹¦ã€äº¬ä¸œã€é˜¿é‡Œäº‘ã€å–œé©¬æ‹‰é›…ã€Amazonã€Slack å’Œ Line ç­‰ç¬¬ä¸‰æ–¹å¹³å°çš„æˆæƒç™»å½•ã€‚ Login, so easy!<br>ç½‘å€ï¼š<a href="https://github.com/justauth/JustAuth" target="_blank" rel="noopener">justauth/JustAuth</a></p>
</blockquote>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs routeros">1.1.  Roles<br><br>   OAuth defines four roles:<br><br>  <span class="hljs-built_in"> resource </span>owner<br>      An entity capable of granting access <span class="hljs-keyword">to</span> a protected resource.<br>      When the<span class="hljs-built_in"> resource </span>owner is a person, it is referred <span class="hljs-keyword">to</span> as an<br>      end-user.<br><br>  <span class="hljs-built_in"> resource </span>server<br>      The<span class="hljs-built_in"> server </span>hosting the protected resources, capable of accepting<br>      <span class="hljs-keyword">and</span> responding <span class="hljs-keyword">to</span> protected<span class="hljs-built_in"> resource </span>requests using access tokens.<br><br>   client<br>      An application making protected<span class="hljs-built_in"> resource </span>requests on behalf of the<br>     <span class="hljs-built_in"> resource </span>owner <span class="hljs-keyword">and</span> with its authorization.  The term <span class="hljs-string">"client"</span> does<br>      <span class="hljs-keyword">not</span> imply any particular implementation characteristics (e.g.,<br>      whether the application executes on a server, a desktop, <span class="hljs-keyword">or</span> other<br>      devices).<br><br>   authorization server<br>      The<span class="hljs-built_in"> server </span>issuing access tokens <span class="hljs-keyword">to</span> the<span class="hljs-built_in"> client </span>after successfully<br>      authenticating the<span class="hljs-built_in"> resource </span>owner <span class="hljs-keyword">and</span> obtaining authorization.<br><br>   The interaction between the authorization<span class="hljs-built_in"> server </span><span class="hljs-keyword">and</span><span class="hljs-built_in"> resource </span>server<br>   is beyond the scope of this specification.  The authorization server<br>   may be the same<span class="hljs-built_in"> server </span>as the<span class="hljs-built_in"> resource server </span><span class="hljs-keyword">or</span> a separate entity.<br>   A single authorization<span class="hljs-built_in"> server </span>may issue access tokens accepted by<br>   multiple<span class="hljs-built_in"> resource </span>servers.<br><br>1.2.  Protocol Flow<br><br>     +--------+                               +---------------+<br>     |        |--(A)- Authorization Request -&gt;|  <span class="hljs-built_in"> Resource </span>   |<br>     |        |                               |     Owner     |<br>     |        |&lt;-(B)-- Authorization Grant ---|               |<br>     |        |                               +---------------+<br>     |        |<br>     |        |                               +---------------+<br>     |        |--(C)-- Authorization Grant --&gt;| Authorization |<br>     |<span class="hljs-built_in"> Client </span>|                               |    <span class="hljs-built_in"> Server </span>   |<br>     |        |&lt;-(D)----- Access Token -------|               |<br>     |        |                               +---------------+<br>     |        |<br>     |        |                               +---------------+<br>     |        |--(E)----- Access Token ------&gt;|   <span class="hljs-built_in"> Resource </span>  |<br>     |        |                               |    <span class="hljs-built_in"> Server </span>   |<br>     |        |&lt;-(F)--- Protected<span class="hljs-built_in"> Resource </span>---|               |<br>     +--------+                               +---------------+<br><br>                     Figure 1: Abstract Protocol Flow<br><br>   The abstract OAuth 2.0 flow illustrated <span class="hljs-keyword">in</span> Figure 1 describes the<br>   interaction between the four roles <span class="hljs-keyword">and</span> includes the following steps:<br><br>   (A)  The<span class="hljs-built_in"> client </span>requests authorization <span class="hljs-keyword">from</span> the<span class="hljs-built_in"> resource </span>owner.  The<br>        authorization request can be made directly <span class="hljs-keyword">to</span> the<span class="hljs-built_in"> resource </span>owner<br>        (as shown), <span class="hljs-keyword">or</span> preferably indirectly via the authorization<br>       <span class="hljs-built_in"> server </span>as an intermediary.<br>		ç”¨æˆ·æ‰“å¼€å®¢æˆ·ç«¯ä»¥åï¼Œå®¢æˆ·ç«¯è¦æ±‚ç”¨æˆ·ç»™äºˆæˆæƒã€‚<br>   (B)  The<span class="hljs-built_in"> client </span>receives an authorization grant, which is a<br>        credential representing the<span class="hljs-built_in"> resource </span>owner<span class="hljs-string">'s authorization,</span><br><span class="hljs-string">        expressed using one of four grant types defined in this</span><br><span class="hljs-string">        specification or using an extension grant type.  The</span><br><span class="hljs-string">        authorization grant type depends on the method used by the</span><br><span class="hljs-string">        client to request authorization and the types supported by the</span><br><span class="hljs-string">        authorization server.</span><br><span class="hljs-string">		ç”¨æˆ·åŒæ„ç»™äºˆå®¢æˆ·ç«¯æˆæƒã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">   (C)  The client requests an access token by authenticating with the</span><br><span class="hljs-string">        authorization server and presenting the authorization grant.</span><br><span class="hljs-string">		å®¢æˆ·ç«¯ä½¿ç”¨ä¸Šä¸€æ­¥è·å¾—çš„æˆæƒï¼Œå‘è®¤è¯æœåŠ¡å™¨ç”³è¯·ä»¤ç‰Œã€‚</span><br><span class="hljs-string">   (D)  The authorization server authenticates the client and validates</span><br><span class="hljs-string">        the authorization grant, and if valid, issues an access token.</span><br><span class="hljs-string">		è®¤è¯æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯è¿›è¡Œè®¤è¯ä»¥åï¼Œç¡®è®¤æ— è¯¯ï¼ŒåŒæ„å‘æ”¾ä»¤ç‰Œ</span><br><span class="hljs-string"></span><br><span class="hljs-string">   (E)  The client requests the protected resource from the resource</span><br><span class="hljs-string">        server and authenticates by presenting the access token.</span><br><span class="hljs-string">		å®¢æˆ·ç«¯ä½¿ç”¨ä»¤ç‰Œï¼Œå‘èµ„æºæœåŠ¡å™¨ç”³è¯·è·å–èµ„æºã€‚</span><br><span class="hljs-string">   (F)  The resource server validates the access token, and if valid,</span><br><span class="hljs-string">        serves the request.</span><br><span class="hljs-string">		èµ„æºæœåŠ¡å™¨ç¡®è®¤ä»¤ç‰Œæ— è¯¯ï¼ŒåŒæ„å‘å®¢æˆ·ç«¯å¼€æ”¾èµ„æºã€‚</span><br><span class="hljs-string">https://datatracker.ietf.org/doc/html/rfc6749#section-1.2</span><br></code></pre></td></tr></table></figure>

<p><img src="http://cdn.lyloou.com/img/justauth%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0-2021-06-29-17-22-17.png" alt="justauthæºç å­¦ä¹ -2021-06-29-17-22-17"></p>
<h2 id="ä»ä»¥ä¸‹å‡ ä¸ªé—®é¢˜æ¥çœ‹ä»£ç "><a href="#ä»ä»¥ä¸‹å‡ ä¸ªé—®é¢˜æ¥çœ‹ä»£ç " class="headerlink" title="ä»ä»¥ä¸‹å‡ ä¸ªé—®é¢˜æ¥çœ‹ä»£ç "></a>ä»ä»¥ä¸‹å‡ ä¸ªé—®é¢˜æ¥çœ‹ä»£ç </h2><h4 id="Q-å¦‚ä½•é›†æˆå¤šå®¶çš„ï¼Ÿ"><a href="#Q-å¦‚ä½•é›†æˆå¤šå®¶çš„ï¼Ÿ" class="headerlink" title="Q: å¦‚ä½•é›†æˆå¤šå®¶çš„ï¼Ÿ"></a>Q: å¦‚ä½•é›†æˆå¤šå®¶çš„ï¼Ÿ</h4><p>è¿™ä¸€å—ï¼Œä¸»è¦æ˜¯å·¥å‚æ¨¡å¼å’Œæ¨¡æ¿æ¨¡å¼çš„åº”ç”¨ã€‚</p>
<p>å·¥å‚æ¨¡å¼</p>
<figure class="highlight leaf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs leaf">AuthRequestFactory<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-variable">String</span> <span class="hljs-variable">source</span>)</span></span><br></code></pre></td></tr></table></figure>

<p>æ¨¡æ¿æ¨¡å¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AuthDefaultRequest</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AuthRequest</span></span>&#123;<br>	<span class="hljs-comment">// ...</span><br>	<span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> AuthToken <span class="hljs-title">getAccessToken</span><span class="hljs-params">(AuthCallback var1)</span></span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> AuthUser <span class="hljs-title">getUserInfo</span><span class="hljs-params">(AuthToken var1)</span></span>;<br>	<span class="hljs-comment">// ...</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="http://cdn.lyloou.com/img/justauth%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0-2021-06-29-17-10-59.png" alt="justauthæºç å­¦ä¹ -2021-06-29-17-10-59"></p>
<p><strong>é’ˆå¯¹æˆæƒã€è·å–ç”¨æˆ·ä¿¡æ¯ç­‰æ“ä½œï¼Œç”±å…·ä½“çš„ source ç±»æ¥å®ç°</strong><br>å› ä¸ºéƒ½æ˜¯åŸºäº OAuth2 æ¥å®ç°çš„ï¼Œæ‰€ä»¥éƒ½æœ‰ authorize åœ°å€ã€accessToken åœ°å€ã€userInfo åœ°å€ ç­‰æ¦‚å¿µ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">AuthSource</span> </span>&#123;<br>    <span class="hljs-function">String <span class="hljs-title">authorize</span><span class="hljs-params">()</span></span>;<br><br>    <span class="hljs-function">String <span class="hljs-title">accessToken</span><span class="hljs-params">()</span></span>;<br><br>    <span class="hljs-function">String <span class="hljs-title">userInfo</span><span class="hljs-params">()</span></span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">default</span> String <span class="hljs-title">revoke</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> AuthException(AuthResponseStatus.UNSUPPORTED);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">default</span> String <span class="hljs-title">refresh</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> AuthException(AuthResponseStatus.UNSUPPORTED);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">default</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span> <span class="hljs-keyword">instanceof</span> Enum ? String.valueOf(<span class="hljs-keyword">this</span>) : <span class="hljs-keyword">this</span>.getClass().getSimpleName();<br>    &#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> AuthDefaultSource implements AuthSource &#123;<br>    GITHUB &#123;<br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">authorize</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">"https://github.com/login/oauth/authorize"</span>;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">accessToken</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">"https://github.com/login/oauth/access_token"</span>;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">userInfo</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">"https://api.github.com/user"</span>;<br>        &#125;<br>    &#125;,<br>    WEIBO &#123;<br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">authorize</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">"https://api.weibo.com/oauth2/authorize"</span>;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">accessToken</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">"https://api.weibo.com/oauth2/access_token"</span>;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">userInfo</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">"https://api.weibo.com/2/users/show.json"</span>;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">revoke</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">"https://api.weibo.com/oauth2/revokeoauth2"</span>;<br>        &#125;<br>    &#125;<br>	<span class="hljs-comment">// ...</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>å¤šå®¶é…ç½®</strong><br>JustAuthPropertiesï¼Œå…¶ type æ˜¯ map ç±»å‹çš„ï¼Œå¯ä»¥è‡ªå®šä¹‰ä»»æ„å¤šä¸ªçš„ sourceã€‚</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">justauth:</span><br>  <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">type:</span><br>    <span class="hljs-attr">QQ:</span><br>      <span class="hljs-attr">client-id:</span> <span class="hljs-number">10</span><span class="hljs-string">**********6</span><br>      <span class="hljs-attr">client-secret:</span> <span class="hljs-string">1f7d08**********5b7**********29e</span><br>      <span class="hljs-attr">redirect-uri:</span> <span class="hljs-string">http://x.lyloou.com/oauth/qq/callback</span><br>      <span class="hljs-attr">union-id:</span> <span class="hljs-literal">false</span><br>    <span class="hljs-attr">WEIBO:</span><br>      <span class="hljs-attr">client-id:</span> <span class="hljs-number">10</span><span class="hljs-string">**********6</span><br>      <span class="hljs-attr">client-secret:</span> <span class="hljs-string">1f7d08**********5b7**********29e</span><br>      <span class="hljs-attr">redirect-uri:</span> <span class="hljs-string">http://x.lyloou.com/oauth/weibo/callback</span><br></code></pre></td></tr></table></figure>

<h4 id="Q-State-ç¼“å­˜å¦‚ä½•å®ç°ï¼Ÿ"><a href="#Q-State-ç¼“å­˜å¦‚ä½•å®ç°ï¼Ÿ" class="headerlink" title="Q: State ç¼“å­˜å¦‚ä½•å®ç°ï¼Ÿ"></a>Q: State ç¼“å­˜å¦‚ä½•å®ç°ï¼Ÿ</h4><p><code>state</code> æ˜¯ ç”¨æ¥ä¿æŒæˆæƒä¼šè¯æµç¨‹å®Œæ•´æ€§ï¼Œé˜²æ­¢ CSRF æ”»å‡»çš„å®‰å…¨çš„éšæœºçš„å‚æ•°ï¼Œç”±å¼€å‘è€…ç”Ÿæˆ</p>
<p><strong>è‡ªåŠ¨é…ç½®</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// justauth-spring-boot-starter JustAuthStateCacheConfiguration</span><br>    <span class="hljs-meta">@ConditionalOnMissingBean</span>(&#123;AuthStateCache<span class="hljs-class">.<span class="hljs-keyword">class</span>&#125;)</span><br><span class="hljs-class">    @<span class="hljs-title">ConditionalOnProperty</span>(</span><br><span class="hljs-class">        <span class="hljs-title">name</span> </span>= &#123;<span class="hljs-string">"justauth.cache.type"</span>&#125;,<br>        havingValue = <span class="hljs-string">"default"</span>,<br>        matchIfMissing = <span class="hljs-keyword">true</span>  <span class="hljs-comment">// é»˜è®¤</span><br>    )<br>    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Default</span> </span>&#123;<br>        Default() &#123;<br>        &#125;<br><br>        <span class="hljs-meta">@Bean</span><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> AuthStateCache <span class="hljs-title">authStateCache</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> AuthDefaultStateCache.INSTANCE;<br>        &#125;<br><br>        <span class="hljs-keyword">static</span> &#123;<br>            JustAuthStateCacheConfiguration.log.debug(<span class="hljs-string">"JustAuth ä½¿ç”¨ é»˜è®¤ç¼“å­˜å­˜å‚¨ state æ•°æ®"</span>);<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure>

<p><strong>é…ç½®</strong></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">justauth:</span><br>  <span class="hljs-attr">cache:</span><br>    <span class="hljs-attr">type:</span> <span class="hljs-string">default</span><br><span class="hljs-string">```</span><br><br><span class="hljs-string">**å®ç°**</span><br><br><span class="hljs-string">**æ¸…ç†**</span><br><br><span class="hljs-string">é€šè¿‡</span> <span class="hljs-string">ScheduledThreadPoolExecutor</span> <span class="hljs-string">æ¯éš”</span> <span class="hljs-string">AuthCacheConfig.timeout</span> <span class="hljs-string">æ¥å®šæ—¶æ¸…ç†</span> <span class="hljs-string">CacheState</span><br><br><span class="hljs-string">```java</span><br><span class="hljs-string">public</span> <span class="hljs-string">void</span> <span class="hljs-string">schedulePrune(long</span> <span class="hljs-string">delay)</span> <span class="hljs-string">&#123;</span><br>	<span class="hljs-string">AuthCacheScheduler.INSTANCE.schedule(this::pruneCache,</span> <span class="hljs-string">delay);</span><br><span class="hljs-string">&#125;</span><br><br><span class="hljs-string">public</span> <span class="hljs-string">enum</span> <span class="hljs-string">AuthCacheScheduler</span> <span class="hljs-string">&#123;</span><br>    <span class="hljs-string">INSTANCE;</span><br><br>    <span class="hljs-string">private</span> <span class="hljs-string">AtomicInteger</span> <span class="hljs-string">cacheTaskNumber</span> <span class="hljs-string">=</span> <span class="hljs-string">new</span> <span class="hljs-string">AtomicInteger(1);</span><br>    <span class="hljs-string">private</span> <span class="hljs-string">ScheduledExecutorService</span> <span class="hljs-string">scheduler;</span><br><br>    <span class="hljs-string">private</span> <span class="hljs-string">AuthCacheScheduler()</span> <span class="hljs-string">&#123;</span><br>        <span class="hljs-string">this.create();</span><br>    <span class="hljs-string">&#125;</span><br><br>    <span class="hljs-string">private</span> <span class="hljs-string">void</span> <span class="hljs-string">create()</span> <span class="hljs-string">&#123;</span><br>        <span class="hljs-string">this.shutdown();</span><br>        <span class="hljs-string">this.scheduler</span> <span class="hljs-string">=</span> <span class="hljs-string">new</span> <span class="hljs-string">ScheduledThreadPoolExecutor(10,</span> <span class="hljs-string">(r)</span> <span class="hljs-string">-&gt;</span> <span class="hljs-string">&#123;</span><br>            <span class="hljs-string">return</span> <span class="hljs-string">new</span> <span class="hljs-string">Thread(r,</span> <span class="hljs-string">String.format("JustAuth-Task-%s",</span> <span class="hljs-string">this.cacheTaskNumber.getAndIncrement()));</span><br>        <span class="hljs-string">&#125;);</span><br>    <span class="hljs-string">&#125;</span><br><br>    <span class="hljs-string">public</span> <span class="hljs-string">void</span> <span class="hljs-string">shutdown()</span> <span class="hljs-string">&#123;</span><br>        <span class="hljs-string">if</span> <span class="hljs-string">(null</span> <span class="hljs-string">!=</span> <span class="hljs-string">this.scheduler)</span> <span class="hljs-string">&#123;</span><br>            <span class="hljs-string">this.scheduler.shutdown();</span><br>        <span class="hljs-string">&#125;</span><br><br>    <span class="hljs-string">&#125;</span><br><br>    <span class="hljs-string">public</span> <span class="hljs-string">void</span> <span class="hljs-string">schedule(Runnable</span> <span class="hljs-string">task,</span> <span class="hljs-string">long</span> <span class="hljs-string">delay)</span> <span class="hljs-string">&#123;</span><br>        <span class="hljs-string">this.scheduler.scheduleAtFixedRate(task,</span> <span class="hljs-string">delay,</span> <span class="hljs-string">delay,</span> <span class="hljs-string">TimeUnit.MILLISECONDS);</span><br>    <span class="hljs-string">&#125;</span><br><span class="hljs-string">&#125;</span><br></code></pre></td></tr></table></figure>

<h4 id="Q-å¦‚ä½•åšåˆ°é€‚é…è‡ªæœ‰çš„-OAuth-æœåŠ¡ï¼Ÿ"><a href="#Q-å¦‚ä½•åšåˆ°é€‚é…è‡ªæœ‰çš„-OAuth-æœåŠ¡ï¼Ÿ" class="headerlink" title="Q: å¦‚ä½•åšåˆ°é€‚é…è‡ªæœ‰çš„ OAuth æœåŠ¡ï¼Ÿ"></a>Q: å¦‚ä½•åšåˆ°é€‚é…è‡ªæœ‰çš„ OAuth æœåŠ¡ï¼Ÿ</h4><p>å’Œä¸Šé¢å…¶ä»–å¹³å°çš„ä¸€æ ·ï¼Œå¯ä»¥è‡ªå®šä¹‰æ¥é€‚é…æ–°çš„å¹³å°ã€‚</p>
<ol>
<li><p>ç»§æ‰¿ AuthSourceï¼ŒåŠ å…¥ authorizeã€accessTokenã€userInfo åœ°å€</p>
</li>
<li><p>å®ç° AuthDefaultRequestï¼Œé‡å†™å‡ ä¸ªåŸºæœ¬çš„ oauth æœåŠ¡æ¥å£ï¼šgetAccessTokenã€getUserInfoã€authorizeã€‚</p>
</li>
<li><p>æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">AuthRequest authRequest = <span class="hljs-keyword">new</span> AuthMyGitlabRequest(AuthConfig.builder()<br>    .clientId(<span class="hljs-string">"63398e403231d4aa7e856cf5413620d536a876cb94e8d10ced0d3191b5d1d246"</span>)<br>    .clientSecret(<span class="hljs-string">"65b0eba68fff019e682e6755882a24dfdbf0a61be55de119cb8970320186c8eb"</span>)<br>    .redirectUri(<span class="hljs-string">"http://127.0.0.1:8443/oauth/callback/mygitlab"</span>)<br>    .build())<br></code></pre></td></tr></table></figure>

</li>
</ol>
<h4 id="Q-å¦‚ä½•æ”¯æŒè‡ªå®šä¹‰-Scopeï¼Ÿ"><a href="#Q-å¦‚ä½•æ”¯æŒè‡ªå®šä¹‰-Scopeï¼Ÿ" class="headerlink" title="Q: å¦‚ä½•æ”¯æŒè‡ªå®šä¹‰ Scopeï¼Ÿ"></a>Q: å¦‚ä½•æ”¯æŒè‡ªå®šä¹‰ Scopeï¼Ÿ</h4><p><a href="https://justauth.wiki/features/customize-scopes.html#%E8%87%AA%E5%AE%9A%E4%B9%89-scope-%E6%8E%A5%E5%85%A5-google-%E5%B9%B3%E5%8F%B0" target="_blank" rel="noopener">è‡ªå®šä¹‰-scope-æ¥å…¥-google-å¹³å°</a></p>
<p><code>scope</code> ç®€å•æ¥è¯´ï¼Œå°±æ˜¯ç”³è¯·å¾—åˆ°æŸä¸ªï¼ˆæŸäº›ï¼‰èŒƒå›´çš„èµ„æºï¼Œè¶…è¿‡æ­¤èŒƒå›´çš„èµ„æºé™åˆ¶è®¿é—®ã€‚</p>
<blockquote>
<p>Scope is a mechanism in OAuth 2.0 to limit an applicationâ€™s access to a userâ€™s account. An application can request one or more scopes, this information is then presented to the user in the consent screen, and the access token issued to the application will be limited to the scopes granted.</p>
<p>â€”â€” ä»¥ä¸Šå†…å®¹èŠ‚é€‰è‡ª<a href="https://oauth.net/" target="_blank" rel="noopener">oauth.net</a><a href="https://oauth.net/" target="_blank" rel="noopener"> (opens new window)</a></p>
</blockquote>
<p>æä¾› AuthScope ç»Ÿä¸€æ¥å£</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å„ä¸ªå¹³å° scope ç±»çš„ç»Ÿä¸€æ¥å£</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> yadong.zhang (yadong.zhang0415(a)gmail.com)</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> 1.0.0</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 1.15.7</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">AuthScope</span> </span>&#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å–å­—ç¬¦ä¸² &#123;<span class="hljs-doctag">@code</span> scope&#125;ï¼Œå¯¹åº”ä¸ºå„å¹³å°å®é™…ä½¿ç”¨çš„ &#123;<span class="hljs-doctag">@code</span> scope&#125;</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> String</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function">String <span class="hljs-title">getScope</span><span class="hljs-params">()</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆ¤æ–­å½“å‰ &#123;<span class="hljs-doctag">@code</span> scope&#125; æ˜¯å¦ä¸ºå„å¹³å°é»˜è®¤å¯ç”¨çš„</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> boolean</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">isDefault</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å„ä¸ªå¹³å°å®ç°æ­¤æ¥å£ï¼Œå¦‚ google</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Google å¹³å° OAuth æˆæƒèŒƒå›´</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> yadong.zhang (yadong.zhang0415(a)gmail.com)</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> 1.0.0</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 1.0.0</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Getter</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> AuthGoogleScope implements AuthScope &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * &#123;<span class="hljs-doctag">@code</span> scope&#125; å«ä¹‰ï¼Œä»¥&#123;<span class="hljs-doctag">@code</span> description&#125; ä¸ºå‡†</span><br><span class="hljs-comment">     */</span><br>    USER_OPENID(<span class="hljs-string">"openid"</span>, <span class="hljs-string">"Associate you with your personal info on Google"</span>, <span class="hljs-keyword">true</span>),<br>    USER_EMAIL(<span class="hljs-string">"email"</span>, <span class="hljs-string">"View your email address"</span>, <span class="hljs-keyword">true</span>),<br>    USER_PROFILE(<span class="hljs-string">"profile"</span>, <span class="hljs-string">"View your basic profile info"</span>, <span class="hljs-keyword">true</span>),<br>    USER_PHONENUMBERS_READ(<span class="hljs-string">"https://www.googleapis.com/auth/user.phonenumbers.read"</span>, <span class="hljs-string">"View your phone numbers"</span>, <span class="hljs-keyword">false</span>),<br>    USER_ORGANIZATION_READ(<span class="hljs-string">"https://www.googleapis.com/auth/user.organization.read"</span>, <span class="hljs-string">"See your education, work history and org info"</span>, <span class="hljs-keyword">false</span>),<br>    USER_GENDER_READ(<span class="hljs-string">"https://www.googleapis.com/auth/user.gender.read"</span>, <span class="hljs-string">"See your gender"</span>, <span class="hljs-keyword">false</span>),<br>    USER_EMAILS_READ(<span class="hljs-string">"https://www.googleapis.com/auth/user.emails.read"</span>, <span class="hljs-string">"View your email addresses"</span>, <span class="hljs-keyword">false</span>),<br><br>    USER_BIRTHDAY_READ(<span class="hljs-string">"https://www.googleapis.com/auth/user.birthday.read"</span>, <span class="hljs-string">"View your complete date of birth"</span>, <span class="hljs-keyword">false</span>)<br>    <span class="hljs-comment">// ...</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>ç»“åˆæµç¨‹å›¾æ¥è¯´ï¼Œï¼ˆAï¼‰è¿™é‡Œéœ€è¦å°† scope å¸¦è¿‡å»ï¼Œè¿›å…¥æˆæƒé¡µé¢ã€‚</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs routeros">+--------+                               +---------------+<br>|        |--(A)- Authorization Request -&gt;|  <span class="hljs-built_in"> Resource </span>   |<br>|        |                               |     Owner     |<br>|        |&lt;-(B)-- Authorization Grant ---|               |<br>|        |                               +---------------+<br>|        |<br>|        |                               +---------------+<br>|        |--(C)-- Authorization Grant --&gt;| Authorization |<br>|<span class="hljs-built_in"> Client </span>|                               |    <span class="hljs-built_in"> Server </span>   |<br>|        |&lt;-(D)----- Access Token -------|               |<br>|        |                               +---------------+<br>|        |<br>|        |                               +---------------+<br>|        |--(E)----- Access Token ------&gt;|   <span class="hljs-built_in"> Resource </span>  |<br>|        |                               |    <span class="hljs-built_in"> Server </span>   |<br>|        |&lt;-(F)--- Protected<span class="hljs-built_in"> Resource </span>---|               |<br>+--------+<br></code></pre></td></tr></table></figure>

<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sas">https://accounts.google.com/o/oauth2/v2/auth?response_type=code<span class="hljs-variable">&amp;client_id</span>=553817080137-d1pe3asc115tfgo74l8me92dhg4ro9k1.apps.googleusercontent.com<span class="hljs-variable">&amp;redirect_uri</span>=http://<span class="hljs-meta">x</span>.lyloou.com/oauth/google/callback<span class="hljs-variable">&amp;state</span>=e829a5725ce69cf1ed7918337caba839<span class="hljs-variable">&amp;access_type</span>=offline<span class="hljs-variable">&amp;scope</span>=openid email profile<span class="hljs-variable">&amp;prompt</span>=select_account<br></code></pre></td></tr></table></figure>

<p>æˆæƒé¡µé¢çš„é“¾æ¥æ˜¯é€šè¿‡ <code>AuthDefaultRequest.authorize</code> æ¥æ‹¼æ¥å¾—åˆ°çš„ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// AuthDefaultRequest.java</span><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è¿”å›å¸¦&#123;<span class="hljs-doctag">@code</span> state&#125;å‚æ•°çš„æˆæƒurlï¼Œæˆæƒå›è°ƒæ—¶ä¼šå¸¦ä¸Šè¿™ä¸ª&#123;<span class="hljs-doctag">@code</span> state&#125;</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> state state éªŒè¯æˆæƒæµç¨‹çš„å‚æ•°ï¼Œå¯ä»¥é˜²æ­¢csrf</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> è¿”å›æˆæƒåœ°å€</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@since</span> 1.9.3</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">authorize</span><span class="hljs-params">(String state)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> UrlBuilder.fromBaseUrl(<span class="hljs-keyword">super</span>.authorize(state))<br>            .queryParam(<span class="hljs-string">"access_type"</span>, <span class="hljs-string">"offline"</span>)<br>            .queryParam(<span class="hljs-string">"scope"</span>, <span class="hljs-keyword">this</span>.getScopes(<span class="hljs-string">" "</span>, <span class="hljs-keyword">false</span>, AuthScopeUtils.getDefaultScopes(AuthGoogleScope.values())))<br>            .queryParam(<span class="hljs-string">"prompt"</span>,<span class="hljs-string">"select_account"</span>)<br>            .build();<br>    &#125;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å–ä»¥ &#123;<span class="hljs-doctag">@code</span> separator&#125;åˆ†å‰²è¿‡åçš„ scope ä¿¡æ¯</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> separator     å¤šä¸ª &#123;<span class="hljs-doctag">@code</span> scope&#125; é—´çš„åˆ†éš”ç¬¦</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> encode        æ˜¯å¦ encode ç¼–ç </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> defaultScopes é»˜è®¤çš„ scopeï¼Œ å½“å®¢æˆ·ç«¯æ²¡æœ‰é…ç½® &#123;<span class="hljs-doctag">@code</span> scopes&#125; æ—¶å¯ç”¨</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> String</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@since</span> 1.16.7</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> String <span class="hljs-title">getScopes</span><span class="hljs-params">(String separator, <span class="hljs-keyword">boolean</span> encode, List&lt;String&gt; defaultScopes)</span> </span>&#123;<br>        List&lt;String&gt; scopes = config.getScopes();<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">null</span> == scopes || scopes.isEmpty()) &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">null</span> == defaultScopes || defaultScopes.isEmpty()) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;<br>            &#125;<br>            scopes = defaultScopes;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">null</span> == separator) &#123;<br>            <span class="hljs-comment">// é»˜è®¤ä¸ºç©ºæ ¼</span><br>            separator = <span class="hljs-string">" "</span>;<br>        &#125;<br>        String scopeStr = String.join(separator, scopes);<br>        <span class="hljs-keyword">return</span> encode ? UrlUtil.urlEncode(scopeStr) : scopeStr;<br>    &#125;<br></code></pre></td></tr></table></figure>

<p><code>getScopes</code> è¿™é‡Œçš„é€»è¾‘æ˜¯ï¼Œå¦‚æœæ²¡æœ‰ä¼ å…¥ scope å‚æ•°ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨é»˜è®¤çš„ scope å‚æ•°ï¼Œå³<code>openid email profile</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">USER_OPENID(<span class="hljs-string">"openid"</span>, <span class="hljs-string">"Associate you with your personal info on Google"</span>, <span class="hljs-keyword">true</span>),<br>USER_EMAIL(<span class="hljs-string">"email"</span>, <span class="hljs-string">"View your email address"</span>, <span class="hljs-keyword">true</span>),<br>USER_PROFILE(<span class="hljs-string">"profile"</span>, <span class="hljs-string">"View your basic profile info"</span>, <span class="hljs-keyword">true</span>),<br></code></pre></td></tr></table></figure>

<p>æ’æ›²ï¼šå¦‚æœä½ æŠŠ email å’Œ profile å–æ¶ˆæ‰ï¼Œè·å–åˆ°ç”¨æˆ·ä¿¡æ¯æ—¶ä¼šå‘ç°å°‘äº† email,profile è¿™äº›ä¿¡æ¯</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-comment">// scope=openid</span><br>&#123;<br>  <span class="hljs-attr">"code"</span>: <span class="hljs-number">2000</span>,<br>  <span class="hljs-attr">"msg"</span>: <span class="hljs-literal">null</span>,<br>  <span class="hljs-attr">"data"</span>: &#123;<br>    <span class="hljs-attr">"uuid"</span>: <span class="hljs-string">"113911973270419053931"</span>,<br>    <span class="hljs-attr">"username"</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">"nickname"</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">"avatar"</span>: <span class="hljs-string">"https://lh3.googleusercontent.com/a-/AOh14GgncI8eYK_uG119BDclub5LNGDn57G_GI4OLZeOBA=s96-c"</span>,<br>    <span class="hljs-attr">"blog"</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">"company"</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">"location"</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">"email"</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">"remark"</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">"gender"</span>: <span class="hljs-string">"UNKNOWN"</span>,<br>    <span class="hljs-attr">"source"</span>: <span class="hljs-string">"GOOGLE"</span>,<br>    <span class="hljs-attr">"token"</span>: &#123;<br>      <span class="hljs-attr">"accessToken"</span>: <span class="hljs-string">"ya29.a0ARrdaM-dddddd-MPjpVj6xJAJP0zZFb396tpmi6BkS_Uom1G7DGTvSaWdJwwOzCXC5Bus-xQjq9JdGfNKWylhl029LMtuyZVT7lKzquGvUFePmellmRoY2Or6RgjS-TwKHzSviQoqEFBcYlQ"</span>,<br>      <span class="hljs-attr">"expireIn"</span>: <span class="hljs-number">3592</span>,<br>      <span class="hljs-attr">"refreshToken"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"refreshTokenExpireIn"</span>: <span class="hljs-number">0</span>,<br>      <span class="hljs-attr">"uid"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"openId"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"accessCode"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"unionId"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"scope"</span>: <span class="hljs-string">"openid"</span>,<br>      <span class="hljs-attr">"tokenType"</span>: <span class="hljs-string">"Bearer"</span>,<br>      <span class="hljs-attr">"idToken"</span>: <span class="hljs-string">"eyJhbGciOiJSUzI1NiIsImtpZCI6ImI2ZjhkNTVkYTUzNGVhOTFjYjJjYjAwZTFhZjRlOGUwY2RlY2E5M2QiLCJ0eXAiOiJKV1QifQ.dddddd.yYUcU9VMwrF3vGXfmR4bsJDeQSjl_msow9eCARiV8HYIyjWDyZUM0ihOqxQzunWUT0W3nRVWxFw4oeN9bhZxIU9jBpW600eJRyDZ6BgJs0QEmC4sjJ4rWPp_P6OFo6b4HEM9Cl5i4ix-cJV18-4BxWhM6WbuC09F3a5RVvp7YGzYhMDRK4fecDpy-7q5wFZws3oYOrjCK5rVu4lioLMTJHCV-THbWImZTrEiuiLxw6onvKwhDa2FfLGbO3tei0EoVTvxJJwi18K-5TzcNySb8yBA-NYTXmlLZ9iWb7NNa7IXqKI1qt0VYm7xUUY4r3G14tZKU6JKkuz07RVx-4zxMw"</span>,<br>      <span class="hljs-attr">"macAlgorithm"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"macKey"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"code"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"oauthToken"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"oauthTokenSecret"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"userId"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"screenName"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"oauthCallbackConfirmed"</span>: <span class="hljs-literal">null</span><br>    &#125;,<br>    <span class="hljs-attr">"rawUserInfo"</span>: &#123;<br>      <span class="hljs-attr">"sub"</span>: <span class="hljs-string">"ddd"</span>,<br>      <span class="hljs-attr">"picture"</span>: <span class="hljs-string">"https://lh3.googleusercontent.com/a-/AOh14GgncI8eYK_uG119BDclub5LNGDn57G_GI4OLZeOBA=s96-c"</span><br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-comment">// scope=openid email profile</span><br>&#123;<br>  <span class="hljs-attr">"code"</span>: <span class="hljs-number">2000</span>,<br>  <span class="hljs-attr">"msg"</span>: <span class="hljs-literal">null</span>,<br>  <span class="hljs-attr">"data"</span>: &#123;<br>    <span class="hljs-attr">"uuid"</span>: <span class="hljs-string">"113911973270419053931"</span>,<br>    <span class="hljs-attr">"username"</span>: <span class="hljs-string">"lyloou6@gmail.com"</span>,<br>    <span class="hljs-attr">"nickname"</span>: <span class="hljs-string">"Lou"</span>,<br>    <span class="hljs-attr">"avatar"</span>: <span class="hljs-string">"https://lh3.googleusercontent.com/a-/AOh14GgncI8eYK_uG119BDclub5LNGDn57G_GI4OLZeOBA=s96-c"</span>,<br>    <span class="hljs-attr">"blog"</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">"company"</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">"location"</span>: <span class="hljs-string">"zh-CN"</span>,<br>    <span class="hljs-attr">"email"</span>: <span class="hljs-string">"lyloou6@gmail.com"</span>,<br>    <span class="hljs-attr">"remark"</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">"gender"</span>: <span class="hljs-string">"UNKNOWN"</span>,<br>    <span class="hljs-attr">"source"</span>: <span class="hljs-string">"GOOGLE"</span>,<br>    <span class="hljs-attr">"token"</span>: &#123;<br>      <span class="hljs-attr">"accessToken"</span>: <span class="hljs-string">"ya29.dd-dddd-eplbTCCWb55DHRZeAGDqDvk5RADufWREONGgKhdtCLa3yWKp4TxTJsyPi2EXYhgmMqV4yVV-NX6swbc38hMXKKGzsTnW4UVaiSOklQ-C1B_af"</span>,<br>      <span class="hljs-attr">"expireIn"</span>: <span class="hljs-number">3599</span>,<br>      <span class="hljs-attr">"refreshToken"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"refreshTokenExpireIn"</span>: <span class="hljs-number">0</span>,<br>      <span class="hljs-attr">"uid"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"openId"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"accessCode"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"unionId"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"scope"</span>: <span class="hljs-string">"openid https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email"</span>,<br>      <span class="hljs-attr">"tokenType"</span>: <span class="hljs-string">"Bearer"</span>,<br>      <span class="hljs-attr">"idToken"</span>: <span class="hljs-string">"dddddddddd"</span>,<br>      <span class="hljs-attr">"macAlgorithm"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"macKey"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"code"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"oauthToken"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"oauthTokenSecret"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"userId"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"screenName"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"oauthCallbackConfirmed"</span>: <span class="hljs-literal">null</span><br>    &#125;,<br>    <span class="hljs-attr">"rawUserInfo"</span>: &#123;<br>      <span class="hljs-attr">"sub"</span>: <span class="hljs-string">"113911973270419053931"</span>,<br>      <span class="hljs-attr">"email_verified"</span>: <span class="hljs-literal">true</span>,<br>      <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Lou"</span>,<br>      <span class="hljs-attr">"given_name"</span>: <span class="hljs-string">"Lou"</span>,<br>      <span class="hljs-attr">"locale"</span>: <span class="hljs-string">"zh-CN"</span>,<br>      <span class="hljs-attr">"picture"</span>: <span class="hljs-string">"https://lh3.googleusercontent.com/a-/AOh14GgncI8eYK_uG119BDclub5LNGDn57G_GI4OLZeOBA=s96-c"</span>,<br>      <span class="hljs-attr">"email"</span>: <span class="hljs-string">"lyloou6@gmail.com"</span><br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/lyloou/img/develop/justauth%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0-2021-07-02-10-50-48.png" alt="justauthæºç å­¦ä¹ -2021-07-02-10-50-48"><br>åé¢è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œå¸¦ä¸Š accessToken æ¥å°±å¯ä»¥è·å–äº†ã€‚</p>
<h4 id="Q-http-å·¥å…·å¦‚ä½•è§£è€¦ï¼Œå¯ä»¥å°†é€‰æ‹©æƒäº¤ç»™å¼€å‘è€…ï¼Ÿ"><a href="#Q-http-å·¥å…·å¦‚ä½•è§£è€¦ï¼Œå¯ä»¥å°†é€‰æ‹©æƒäº¤ç»™å¼€å‘è€…ï¼Ÿ" class="headerlink" title="Q: http å·¥å…·å¦‚ä½•è§£è€¦ï¼Œå¯ä»¥å°†é€‰æ‹©æƒäº¤ç»™å¼€å‘è€…ï¼Ÿ"></a>Q: http å·¥å…·å¦‚ä½•è§£è€¦ï¼Œå¯ä»¥å°†é€‰æ‹©æƒäº¤ç»™å¼€å‘è€…ï¼Ÿ</h4><p>ä½œè€…å¼•å…¥äº†è‡ªå·±å®ç°çš„ <code>simple-http</code> å·¥å…·åŒ… <a href="https://github.com/xkcoding/simple-http" target="_blank" rel="noopener">xkcoding/simple-http: æŠ½å–ä¸€ä¸ªç®€å• HTTP çš„é€šç”¨æ¥å£ï¼Œåº•å±‚å®ç°æ ¹æ®å…·ä½“å¼•å…¥ä¾èµ–æŒ‡å®šã€‚</a></p>
<p>ä» <code>AuthGithubRequest#getUserInfo</code> å¼€å§‹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> AuthUser <span class="hljs-title">getUserInfo</span><span class="hljs-params">(AuthToken authToken)</span> </span>&#123;<br>    HttpHeader header = <span class="hljs-keyword">new</span> HttpHeader();<br>    header.add(<span class="hljs-string">"Authorization"</span>, <span class="hljs-string">"token "</span> + authToken.getAccessToken());<br>    String response = (<span class="hljs-keyword">new</span> HttpUtils(<span class="hljs-keyword">this</span>.config.getHttpConfig())).get(UrlBuilder.fromBaseUrl(<span class="hljs-keyword">this</span>.source.userInfo()).build(), (Map)<span class="hljs-keyword">null</span>, header, <span class="hljs-keyword">false</span>);<br>    JSONObject object = JSONObject.parseObject(response);<br>    <span class="hljs-keyword">this</span>.checkResponse(object.containsKey(<span class="hljs-string">"error"</span>), object.getString(<span class="hljs-string">"error_description"</span>));<br>    <span class="hljs-keyword">return</span> AuthUser.builder().rawUserInfo(object).uuid(object.getString(<span class="hljs-string">"id"</span>)).username(object.getString(<span class="hljs-string">"login"</span>)).avatar(object.getString(<span class="hljs-string">"avatar_url"</span>)).blog(object.getString(<span class="hljs-string">"blog"</span>)).nickname(object.getString(<span class="hljs-string">"name"</span>)).company(object.getString(<span class="hljs-string">"company"</span>)).location(object.getString(<span class="hljs-string">"location"</span>)).email(object.getString(<span class="hljs-string">"email"</span>)).remark(object.getString(<span class="hljs-string">"bio"</span>)).gender(AuthUserGender.UNKNOWN).token(authToken).source(<span class="hljs-keyword">this</span>.source.toString()).build();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>è¿™é‡Œå®ä¾‹åŒ–äº†ä¸€ä¸ª HttpUtils å·¥å…·ç±» <code>new HttpUtils(this.config.getHttpConfig())</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HttpUtils</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">HttpUtils</span><span class="hljs-params">(HttpConfig config)</span> </span>&#123;<br>        HttpUtil.setConfig(config);<br>    &#125;<br>    <span class="hljs-comment">// ...</span><br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HttpUtil</span></span>&#123;<br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setConfig</span><span class="hljs-params">(HttpConfig httpConfig)</span> </span>&#123;<br>		checkHttpNotNull(proxy);<br>		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">null</span> == httpConfig) &#123;<br>			httpConfig = HttpConfig.builder().timeout(Constants.DEFAULT_TIMEOUT).build();<br>		&#125;<br>		proxy.setHttpConfig(httpConfig);<br>	&#125;<br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">checkHttpNotNull</span><span class="hljs-params">(Http proxy)</span> </span>&#123;<br>		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">null</span> == proxy) &#123;<br>			selectHttpProxy();<br>		&#125;<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ° <code>selectHttpProxy()</code>è¿™é‡Œæ˜¯å…³é”®ï¼Œé€šè¿‡ <code>ClassUtil.isPresent</code>çš„æ–¹å¼ï¼ˆå³<code>Class.forName</code>ï¼‰æ¥ç¡®å®š class æ˜¯å¦å¯ä»¥è¢«åŠ è½½ï¼Œä»ä¸Šåˆ°ä¸‹ï¼Œå¦‚æœå¯ä»¥è¢«åŠ è½½ï¼Œå°±ä½œä¸º http çš„å…·ä½“ä»£ç†ã€‚ï¼ˆæ‰€ä»¥å¼•å…¥äº†ç›¸å…³çš„ http ä¾èµ–ï¼Œ<code>HttpUtils</code> å°±å¯ä»¥ç›´æ¥æ‹¿æ¥ä½¿ç”¨äº†ï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HttpUtil</span> </span>&#123;<br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> AbstractHttp proxy;<br><br>	<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">selectHttpProxy</span><span class="hljs-params">()</span> </span>&#123;<br>		AbstractHttp defaultProxy = <span class="hljs-keyword">null</span>;<br>		ClassLoader classLoader = HttpUtil<span class="hljs-class">.<span class="hljs-keyword">class</span>.<span class="hljs-title">getClassLoader</span>()</span>;<br>		<span class="hljs-comment">// åŸºäº java 11 HttpClient</span><br>		<span class="hljs-keyword">if</span> (ClassUtil.isPresent(<span class="hljs-string">"java.net.http.HttpClient"</span>, classLoader)) &#123;<br>			defaultProxy = getHttpProxy(com.xkcoding.http.support.java11.HttpClientImpl<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span>;<br>		&#125;<br>		<span class="hljs-comment">// åŸºäº okhttp3</span><br>		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">null</span> == defaultProxy &amp;&amp; ClassUtil.isPresent(<span class="hljs-string">"okhttp3.OkHttpClient"</span>, classLoader)) &#123;<br>			defaultProxy = getHttpProxy(com.xkcoding.http.support.okhttp3.OkHttp3Impl<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span>;<br>		&#125;<br>		<span class="hljs-comment">// åŸºäº httpclient</span><br>		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">null</span> == defaultProxy &amp;&amp; ClassUtil.isPresent(<span class="hljs-string">"org.apache.http.impl.client.HttpClients"</span>, classLoader)) &#123;<br>			defaultProxy = getHttpProxy(com.xkcoding.http.support.httpclient.HttpClientImpl<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span>;<br>		&#125;<br>		<span class="hljs-comment">// åŸºäº hutool</span><br>		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">null</span> == defaultProxy &amp;&amp; ClassUtil.isPresent(<span class="hljs-string">"cn.hutool.http.HttpRequest"</span>, classLoader)) &#123;<br>			defaultProxy = getHttpProxy(com.xkcoding.http.support.hutool.HutoolImpl<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span>;<br>		&#125;<br><br>		<span class="hljs-keyword">if</span> (defaultProxy == <span class="hljs-keyword">null</span>) &#123;<br>			<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> SimpleHttpException(<span class="hljs-string">"Has no HttpImpl defined in environment!"</span>);<br>		&#125;<br><br>		proxy = defaultProxy;<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¦‚ä¸‹å›¾ï¼Œæ˜¯ <code>simpleHttp</code> é»˜è®¤æ”¯æŒçš„ Http å·¥å…·ã€‚</p>
<p><img src="http://cdn.lyloou.com/img/20210625112103.png" alt="image-20210625112056585"></p>
<p>ä¹Ÿå¯ä»¥è‡ªå·±ç»§æ‰¿ <code>AbstractHttp</code>ï¼Œç„¶åè°ƒç”¨ <code>HttpUtil#setHttp(AbstractHttp http)</code> æ–¹æ³•æ¥æ¥å…¥è‡ªå·±å®ç°çš„ http å·¥å…·ã€‚</p>
<p>æ‰€æœ‰å®ç° AbstractHttp å’Œ Http çš„ç±»ï¼Œéœ€è¦è‡ªå·±å®ç° ä¸€ç³»åˆ—çš„<code>get</code>ã€ <code>post</code> æ–¹æ³•ï¼ˆå³å°è£…ï¼‰ã€‚è¿è¡Œæ—¶é€šè¿‡é¢å‘å¯¹è±¡ä¸­çš„å¤šæ€æ¥å†³å®šå…·ä½“çš„å®ç°è€…ã€‚</p>

    </div>

    
    
    
      
  <div class="popular-posts-header">ç›¸å…³æ–‡ç« </div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/android/å­¦ä¹ èµ„æ–™/" rel="bookmark">Androidå­¦ä¹ èµ„æ–™</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/business/Tokenèº«ä»½è®¤è¯è®¾è®¡/" rel="bookmark">åŸºäº AOP å’Œ JWT å®ç°çš„ Token èº«ä»½è®¤è¯ç»„ä»¶</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/business/ç­¾åè®¾è®¡/" rel="bookmark">æ¥å£ç­¾åæ ¡éªŒè®¾è®¡</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/java/Equable/" rel="bookmark">ã€Javaã€‘é€šè¿‡ Getter æ–¹æ³•å¼•ç”¨ï¼Œæ¥æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/java/Java8/" rel="bookmark">Java8</a></div>
    </li>
  </ul>

        

  <div class="followme">
    <p>æ¬¢è¿å…³æ³¨æˆ‘çš„å…¶å®ƒå‘å¸ƒæ¸ é“</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="/images/wechat_channel.jpg">
            <span class="icon">
              <i class="wechat"></i>
            </span>

            <span class="label">WeChat</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/java/" rel="tag"># java</a>
              <a href="/tags/%E6%BA%90%E7%A0%81/" rel="tag"># æºç </a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/business/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/" rel="prev" title="åˆ†å¸ƒå¼äº‹åŠ¡">
      <i class="fa fa-chevron-left"></i> åˆ†å¸ƒå¼äº‹åŠ¡
    </a></div>
      <div class="post-nav-item">
    <a href="/business/%E7%AD%BE%E5%90%8D%E8%AE%BE%E8%AE%A1/" rel="next" title="æ¥å£ç­¾åæ ¡éªŒè®¾è®¡">
      æ¥å£ç­¾åæ ¡éªŒè®¾è®¡ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#JustAuth-ç®€ä»‹"><span class="nav-number">1.</span> <span class="nav-text">JustAuth ç®€ä»‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ä»ä»¥ä¸‹å‡ ä¸ªé—®é¢˜æ¥çœ‹ä»£ç "><span class="nav-number">2.</span> <span class="nav-text">ä»ä»¥ä¸‹å‡ ä¸ªé—®é¢˜æ¥çœ‹ä»£ç </span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Q-å¦‚ä½•é›†æˆå¤šå®¶çš„ï¼Ÿ"><span class="nav-number">2.0.1.</span> <span class="nav-text">Q: å¦‚ä½•é›†æˆå¤šå®¶çš„ï¼Ÿ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Q-State-ç¼“å­˜å¦‚ä½•å®ç°ï¼Ÿ"><span class="nav-number">2.0.2.</span> <span class="nav-text">Q: State ç¼“å­˜å¦‚ä½•å®ç°ï¼Ÿ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Q-å¦‚ä½•åšåˆ°é€‚é…è‡ªæœ‰çš„-OAuth-æœåŠ¡ï¼Ÿ"><span class="nav-number">2.0.3.</span> <span class="nav-text">Q: å¦‚ä½•åšåˆ°é€‚é…è‡ªæœ‰çš„ OAuth æœåŠ¡ï¼Ÿ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Q-å¦‚ä½•æ”¯æŒè‡ªå®šä¹‰-Scopeï¼Ÿ"><span class="nav-number">2.0.4.</span> <span class="nav-text">Q: å¦‚ä½•æ”¯æŒè‡ªå®šä¹‰ Scopeï¼Ÿ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Q-http-å·¥å…·å¦‚ä½•è§£è€¦ï¼Œå¯ä»¥å°†é€‰æ‹©æƒäº¤ç»™å¼€å‘è€…ï¼Ÿ"><span class="nav-number">2.0.5.</span> <span class="nav-text">Q: http å·¥å…·å¦‚ä½•è§£è€¦ï¼Œå¯ä»¥å°†é€‰æ‹©æƒäº¤ç»™å¼€å‘è€…ï¼Ÿ</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="lyloou"
      src="/assets/images/avatar.png">
  <p class="site-author-name" itemprop="name">lyloou</p>
  <div class="site-description" itemprop="description">/* Better than last best */</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">312</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">56</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/lyloou" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;lyloou" rel="noopener" target="_blank">GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:lyloou6@gmail.com" title="E-Mail â†’ mailto:lyloou6@gmail.com" rel="noopener" target="_blank">E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/lyloou" title="Weibo â†’ https:&#x2F;&#x2F;weibo.com&#x2F;lyloou" rel="noopener" target="_blank">Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/ly1414725328" title="CSDN â†’ https:&#x2F;&#x2F;blog.csdn.net&#x2F;ly1414725328" rel="noopener" target="_blank">CSDN</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">ç²¤ICPå¤‡18151128å· </a>
  </div>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">lyloou</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> å¼ºåŠ›é©±åŠ¨
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>

<script src="/js/utils.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>











<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '5776a56ec2a831d83dfc',
      clientSecret: '28440989ccf00f0ce8dbd425dc5d1eaa1eb24c7b',
      repo        : 'lyloou.github.io',
      owner       : 'lyloou',
      admin       : [''],
      id          : '3c502ac7b57e8d414f74ee0311acab1b',
        language: '',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
