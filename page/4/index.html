<!DOCTYPE html>
<html lang="zh-CN,zh-HK,zh-TW,en,default">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"lyloou.github.io","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"default"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":{"gitalk":{"order":-2}}},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="&#x2F;* Better than last best *&#x2F;">
<meta property="og:type" content="website">
<meta property="og:title" content="lyloou">
<meta property="og:url" content="https://lyloou.github.io/page/4/index.html">
<meta property="og:site_name" content="lyloou">
<meta property="og:description" content="&#x2F;* Better than last best *&#x2F;">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="lyloou">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://lyloou.github.io/page/4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>lyloou</title>
  
    <script>
      function sendPageView() {
        if (CONFIG.hostname !== location.hostname) return;
        var uid = localStorage.getItem('uid') || (Math.random() + '.' + Math.random());
        localStorage.setItem('uid', uid);
        navigator.sendBeacon('https://www.google-analytics.com/collect', new URLSearchParams({
          v  : 1,
          tid: 'UA-80542932-1',
          cid: uid,
          t  : 'pageview',
          dp : encodeURIComponent(location.pathname)
        }));
      }
      document.addEventListener('pjax:complete', sendPageView);
      sendPageView();
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta custom-logo">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">lyloou</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>å½’æ¡£</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://lyloou.github.io/%E8%AF%BB%E6%BA%90%E7%A0%81/justauth%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/assets/images/avatar.png">
      <meta itemprop="name" content="lyloou">
      <meta itemprop="description" content="/* Better than last best */">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lyloou">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/%E8%AF%BB%E6%BA%90%E7%A0%81/justauth%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0/" class="post-title-link" itemprop="url">Justauthæºç å­¦ä¹ </a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-06-25 10:44:54" itemprop="dateCreated datePublished" datetime="2021-06-25T10:44:54+08:00">2021-06-25</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="JustAuth-ç®€ä»‹"><a href="#JustAuth-ç®€ä»‹" class="headerlink" title="JustAuth ç®€ä»‹"></a>JustAuth ç®€ä»‹</h2><blockquote>
<p>ğŸ†Gitee æœ€æœ‰ä»·å€¼å¼€æºé¡¹ç›® ğŸš€ğŸ’¯ å°è€Œå…¨è€Œç¾çš„ç¬¬ä¸‰æ–¹ç™»å½•å¼€æºç»„ä»¶ã€‚ç›®å‰å·²æ”¯æŒ Githubã€Giteeã€å¾®åšã€é’‰é’‰ã€ç™¾åº¦ã€Codingã€è…¾è®¯äº‘å¼€å‘è€…å¹³å°ã€OSChinaã€æ”¯ä»˜å®ã€QQã€å¾®ä¿¡ã€æ·˜å®ã€Googleã€Facebookã€æŠ–éŸ³ã€é¢†è‹±ã€å°ç±³ã€å¾®è½¯ã€ä»Šæ—¥å¤´æ¡ã€Teambitionã€StackOverflowã€Pinterestã€äººäººã€åä¸ºã€ä¼ä¸šå¾®ä¿¡ã€é…·å®¶ä¹ã€Gitlabã€ç¾å›¢ã€é¥¿äº†ä¹ˆã€æ¨ç‰¹ã€é£ä¹¦ã€äº¬ä¸œã€é˜¿é‡Œäº‘ã€å–œé©¬æ‹‰é›…ã€Amazonã€Slack å’Œ Line ç­‰ç¬¬ä¸‰æ–¹å¹³å°çš„æˆæƒç™»å½•ã€‚ Login, so easy!<br>ç½‘å€ï¼š<a href="https://github.com/justauth/JustAuth" target="_blank" rel="noopener">justauth/JustAuth</a></p>
</blockquote>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs routeros">1.1.  Roles<br><br>   OAuth defines four roles:<br><br>  <span class="hljs-built_in"> resource </span>owner<br>      An entity capable of granting access <span class="hljs-keyword">to</span> a protected resource.<br>      When the<span class="hljs-built_in"> resource </span>owner is a person, it is referred <span class="hljs-keyword">to</span> as an<br>      end-user.<br><br>  <span class="hljs-built_in"> resource </span>server<br>      The<span class="hljs-built_in"> server </span>hosting the protected resources, capable of accepting<br>      <span class="hljs-keyword">and</span> responding <span class="hljs-keyword">to</span> protected<span class="hljs-built_in"> resource </span>requests using access tokens.<br><br>   client<br>      An application making protected<span class="hljs-built_in"> resource </span>requests on behalf of the<br>     <span class="hljs-built_in"> resource </span>owner <span class="hljs-keyword">and</span> with its authorization.  The term <span class="hljs-string">"client"</span> does<br>      <span class="hljs-keyword">not</span> imply any particular implementation characteristics (e.g.,<br>      whether the application executes on a server, a desktop, <span class="hljs-keyword">or</span> other<br>      devices).<br><br>   authorization server<br>      The<span class="hljs-built_in"> server </span>issuing access tokens <span class="hljs-keyword">to</span> the<span class="hljs-built_in"> client </span>after successfully<br>      authenticating the<span class="hljs-built_in"> resource </span>owner <span class="hljs-keyword">and</span> obtaining authorization.<br><br>   The interaction between the authorization<span class="hljs-built_in"> server </span><span class="hljs-keyword">and</span><span class="hljs-built_in"> resource </span>server<br>   is beyond the scope of this specification.  The authorization server<br>   may be the same<span class="hljs-built_in"> server </span>as the<span class="hljs-built_in"> resource server </span><span class="hljs-keyword">or</span> a separate entity.<br>   A single authorization<span class="hljs-built_in"> server </span>may issue access tokens accepted by<br>   multiple<span class="hljs-built_in"> resource </span>servers.<br><br>1.2.  Protocol Flow<br><br>     +--------+                               +---------------+<br>     |        |--(A)- Authorization Request -&gt;|  <span class="hljs-built_in"> Resource </span>   |<br>     |        |                               |     Owner     |<br>     |        |&lt;-(B)-- Authorization Grant ---|               |<br>     |        |                               +---------------+<br>     |        |<br>     |        |                               +---------------+<br>     |        |--(C)-- Authorization Grant --&gt;| Authorization |<br>     |<span class="hljs-built_in"> Client </span>|                               |    <span class="hljs-built_in"> Server </span>   |<br>     |        |&lt;-(D)----- Access Token -------|               |<br>     |        |                               +---------------+<br>     |        |<br>     |        |                               +---------------+<br>     |        |--(E)----- Access Token ------&gt;|   <span class="hljs-built_in"> Resource </span>  |<br>     |        |                               |    <span class="hljs-built_in"> Server </span>   |<br>     |        |&lt;-(F)--- Protected<span class="hljs-built_in"> Resource </span>---|               |<br>     +--------+                               +---------------+<br><br>                     Figure 1: Abstract Protocol Flow<br><br>   The abstract OAuth 2.0 flow illustrated <span class="hljs-keyword">in</span> Figure 1 describes the<br>   interaction between the four roles <span class="hljs-keyword">and</span> includes the following steps:<br><br>   (A)  The<span class="hljs-built_in"> client </span>requests authorization <span class="hljs-keyword">from</span> the<span class="hljs-built_in"> resource </span>owner.  The<br>        authorization request can be made directly <span class="hljs-keyword">to</span> the<span class="hljs-built_in"> resource </span>owner<br>        (as shown), <span class="hljs-keyword">or</span> preferably indirectly via the authorization<br>       <span class="hljs-built_in"> server </span>as an intermediary.<br>		ç”¨æˆ·æ‰“å¼€å®¢æˆ·ç«¯ä»¥åï¼Œå®¢æˆ·ç«¯è¦æ±‚ç”¨æˆ·ç»™äºˆæˆæƒã€‚<br>   (B)  The<span class="hljs-built_in"> client </span>receives an authorization grant, which is a<br>        credential representing the<span class="hljs-built_in"> resource </span>owner<span class="hljs-string">'s authorization,</span><br><span class="hljs-string">        expressed using one of four grant types defined in this</span><br><span class="hljs-string">        specification or using an extension grant type.  The</span><br><span class="hljs-string">        authorization grant type depends on the method used by the</span><br><span class="hljs-string">        client to request authorization and the types supported by the</span><br><span class="hljs-string">        authorization server.</span><br><span class="hljs-string">		ç”¨æˆ·åŒæ„ç»™äºˆå®¢æˆ·ç«¯æˆæƒã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">   (C)  The client requests an access token by authenticating with the</span><br><span class="hljs-string">        authorization server and presenting the authorization grant.</span><br><span class="hljs-string">		å®¢æˆ·ç«¯ä½¿ç”¨ä¸Šä¸€æ­¥è·å¾—çš„æˆæƒï¼Œå‘è®¤è¯æœåŠ¡å™¨ç”³è¯·ä»¤ç‰Œã€‚</span><br><span class="hljs-string">   (D)  The authorization server authenticates the client and validates</span><br><span class="hljs-string">        the authorization grant, and if valid, issues an access token.</span><br><span class="hljs-string">		è®¤è¯æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯è¿›è¡Œè®¤è¯ä»¥åï¼Œç¡®è®¤æ— è¯¯ï¼ŒåŒæ„å‘æ”¾ä»¤ç‰Œ</span><br><span class="hljs-string"></span><br><span class="hljs-string">   (E)  The client requests the protected resource from the resource</span><br><span class="hljs-string">        server and authenticates by presenting the access token.</span><br><span class="hljs-string">		å®¢æˆ·ç«¯ä½¿ç”¨ä»¤ç‰Œï¼Œå‘èµ„æºæœåŠ¡å™¨ç”³è¯·è·å–èµ„æºã€‚</span><br><span class="hljs-string">   (F)  The resource server validates the access token, and if valid,</span><br><span class="hljs-string">        serves the request.</span><br><span class="hljs-string">		èµ„æºæœåŠ¡å™¨ç¡®è®¤ä»¤ç‰Œæ— è¯¯ï¼ŒåŒæ„å‘å®¢æˆ·ç«¯å¼€æ”¾èµ„æºã€‚</span><br><span class="hljs-string">https://datatracker.ietf.org/doc/html/rfc6749#section-1.2</span><br></code></pre></td></tr></table></figure>

<p><img src="http://cdn.lyloou.com/img/justauth%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0-2021-06-29-17-22-17.png" alt="justauthæºç å­¦ä¹ -2021-06-29-17-22-17"></p>
<h2 id="ä»ä»¥ä¸‹å‡ ä¸ªé—®é¢˜æ¥çœ‹ä»£ç "><a href="#ä»ä»¥ä¸‹å‡ ä¸ªé—®é¢˜æ¥çœ‹ä»£ç " class="headerlink" title="ä»ä»¥ä¸‹å‡ ä¸ªé—®é¢˜æ¥çœ‹ä»£ç "></a>ä»ä»¥ä¸‹å‡ ä¸ªé—®é¢˜æ¥çœ‹ä»£ç </h2><h4 id="Q-å¦‚ä½•é›†æˆå¤šå®¶çš„ï¼Ÿ"><a href="#Q-å¦‚ä½•é›†æˆå¤šå®¶çš„ï¼Ÿ" class="headerlink" title="Q: å¦‚ä½•é›†æˆå¤šå®¶çš„ï¼Ÿ"></a>Q: å¦‚ä½•é›†æˆå¤šå®¶çš„ï¼Ÿ</h4><p>è¿™ä¸€å—ï¼Œä¸»è¦æ˜¯å·¥å‚æ¨¡å¼å’Œæ¨¡æ¿æ¨¡å¼çš„åº”ç”¨ã€‚</p>
<p>å·¥å‚æ¨¡å¼</p>
<figure class="highlight leaf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs leaf">AuthRequestFactory<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-variable">String</span> <span class="hljs-variable">source</span>)</span></span><br></code></pre></td></tr></table></figure>

<p>æ¨¡æ¿æ¨¡å¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AuthDefaultRequest</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AuthRequest</span></span>&#123;<br>	<span class="hljs-comment">// ...</span><br>	<span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> AuthToken <span class="hljs-title">getAccessToken</span><span class="hljs-params">(AuthCallback var1)</span></span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> AuthUser <span class="hljs-title">getUserInfo</span><span class="hljs-params">(AuthToken var1)</span></span>;<br>	<span class="hljs-comment">// ...</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="http://cdn.lyloou.com/img/justauth%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0-2021-06-29-17-10-59.png" alt="justauthæºç å­¦ä¹ -2021-06-29-17-10-59"></p>
<p><strong>é’ˆå¯¹æˆæƒã€è·å–ç”¨æˆ·ä¿¡æ¯ç­‰æ“ä½œï¼Œç”±å…·ä½“çš„ source ç±»æ¥å®ç°</strong><br>å› ä¸ºéƒ½æ˜¯åŸºäº OAuth2 æ¥å®ç°çš„ï¼Œæ‰€ä»¥éƒ½æœ‰ authorize åœ°å€ã€accessToken åœ°å€ã€userInfo åœ°å€ ç­‰æ¦‚å¿µ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">AuthSource</span> </span>&#123;<br>    <span class="hljs-function">String <span class="hljs-title">authorize</span><span class="hljs-params">()</span></span>;<br><br>    <span class="hljs-function">String <span class="hljs-title">accessToken</span><span class="hljs-params">()</span></span>;<br><br>    <span class="hljs-function">String <span class="hljs-title">userInfo</span><span class="hljs-params">()</span></span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">default</span> String <span class="hljs-title">revoke</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> AuthException(AuthResponseStatus.UNSUPPORTED);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">default</span> String <span class="hljs-title">refresh</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> AuthException(AuthResponseStatus.UNSUPPORTED);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">default</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span> <span class="hljs-keyword">instanceof</span> Enum ? String.valueOf(<span class="hljs-keyword">this</span>) : <span class="hljs-keyword">this</span>.getClass().getSimpleName();<br>    &#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> AuthDefaultSource implements AuthSource &#123;<br>    GITHUB &#123;<br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">authorize</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">"https://github.com/login/oauth/authorize"</span>;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">accessToken</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">"https://github.com/login/oauth/access_token"</span>;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">userInfo</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">"https://api.github.com/user"</span>;<br>        &#125;<br>    &#125;,<br>    WEIBO &#123;<br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">authorize</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">"https://api.weibo.com/oauth2/authorize"</span>;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">accessToken</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">"https://api.weibo.com/oauth2/access_token"</span>;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">userInfo</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">"https://api.weibo.com/2/users/show.json"</span>;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">revoke</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">"https://api.weibo.com/oauth2/revokeoauth2"</span>;<br>        &#125;<br>    &#125;<br>	<span class="hljs-comment">// ...</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>å¤šå®¶é…ç½®</strong><br>JustAuthPropertiesï¼Œå…¶ type æ˜¯ map ç±»å‹çš„ï¼Œå¯ä»¥è‡ªå®šä¹‰ä»»æ„å¤šä¸ªçš„ sourceã€‚</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">justauth:</span><br>  <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">type:</span><br>    <span class="hljs-attr">QQ:</span><br>      <span class="hljs-attr">client-id:</span> <span class="hljs-number">10</span><span class="hljs-string">**********6</span><br>      <span class="hljs-attr">client-secret:</span> <span class="hljs-string">1f7d08**********5b7**********29e</span><br>      <span class="hljs-attr">redirect-uri:</span> <span class="hljs-string">http://x.lyloou.com/oauth/qq/callback</span><br>      <span class="hljs-attr">union-id:</span> <span class="hljs-literal">false</span><br>    <span class="hljs-attr">WEIBO:</span><br>      <span class="hljs-attr">client-id:</span> <span class="hljs-number">10</span><span class="hljs-string">**********6</span><br>      <span class="hljs-attr">client-secret:</span> <span class="hljs-string">1f7d08**********5b7**********29e</span><br>      <span class="hljs-attr">redirect-uri:</span> <span class="hljs-string">http://x.lyloou.com/oauth/weibo/callback</span><br></code></pre></td></tr></table></figure>

<h4 id="Q-State-ç¼“å­˜å¦‚ä½•å®ç°ï¼Ÿ"><a href="#Q-State-ç¼“å­˜å¦‚ä½•å®ç°ï¼Ÿ" class="headerlink" title="Q: State ç¼“å­˜å¦‚ä½•å®ç°ï¼Ÿ"></a>Q: State ç¼“å­˜å¦‚ä½•å®ç°ï¼Ÿ</h4><p><code>state</code> æ˜¯ ç”¨æ¥ä¿æŒæˆæƒä¼šè¯æµç¨‹å®Œæ•´æ€§ï¼Œé˜²æ­¢ CSRF æ”»å‡»çš„å®‰å…¨çš„éšæœºçš„å‚æ•°ï¼Œç”±å¼€å‘è€…ç”Ÿæˆ</p>
<p><strong>è‡ªåŠ¨é…ç½®</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// justauth-spring-boot-starter JustAuthStateCacheConfiguration</span><br>    <span class="hljs-meta">@ConditionalOnMissingBean</span>(&#123;AuthStateCache<span class="hljs-class">.<span class="hljs-keyword">class</span>&#125;)</span><br><span class="hljs-class">    @<span class="hljs-title">ConditionalOnProperty</span>(</span><br><span class="hljs-class">        <span class="hljs-title">name</span> </span>= &#123;<span class="hljs-string">"justauth.cache.type"</span>&#125;,<br>        havingValue = <span class="hljs-string">"default"</span>,<br>        matchIfMissing = <span class="hljs-keyword">true</span>  <span class="hljs-comment">// é»˜è®¤</span><br>    )<br>    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Default</span> </span>&#123;<br>        Default() &#123;<br>        &#125;<br><br>        <span class="hljs-meta">@Bean</span><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> AuthStateCache <span class="hljs-title">authStateCache</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> AuthDefaultStateCache.INSTANCE;<br>        &#125;<br><br>        <span class="hljs-keyword">static</span> &#123;<br>            JustAuthStateCacheConfiguration.log.debug(<span class="hljs-string">"JustAuth ä½¿ç”¨ é»˜è®¤ç¼“å­˜å­˜å‚¨ state æ•°æ®"</span>);<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure>

<p><strong>é…ç½®</strong></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">justauth:</span><br>  <span class="hljs-attr">cache:</span><br>    <span class="hljs-attr">type:</span> <span class="hljs-string">default</span><br><span class="hljs-string">```</span><br><br><span class="hljs-string">**å®ç°**</span><br><br><span class="hljs-string">**æ¸…ç†**</span><br><br><span class="hljs-string">é€šè¿‡</span> <span class="hljs-string">ScheduledThreadPoolExecutor</span> <span class="hljs-string">æ¯éš”</span> <span class="hljs-string">AuthCacheConfig.timeout</span> <span class="hljs-string">æ¥å®šæ—¶æ¸…ç†</span> <span class="hljs-string">CacheState</span><br><br><span class="hljs-string">```java</span><br><span class="hljs-string">public</span> <span class="hljs-string">void</span> <span class="hljs-string">schedulePrune(long</span> <span class="hljs-string">delay)</span> <span class="hljs-string">&#123;</span><br>	<span class="hljs-string">AuthCacheScheduler.INSTANCE.schedule(this::pruneCache,</span> <span class="hljs-string">delay);</span><br><span class="hljs-string">&#125;</span><br><br><span class="hljs-string">public</span> <span class="hljs-string">enum</span> <span class="hljs-string">AuthCacheScheduler</span> <span class="hljs-string">&#123;</span><br>    <span class="hljs-string">INSTANCE;</span><br><br>    <span class="hljs-string">private</span> <span class="hljs-string">AtomicInteger</span> <span class="hljs-string">cacheTaskNumber</span> <span class="hljs-string">=</span> <span class="hljs-string">new</span> <span class="hljs-string">AtomicInteger(1);</span><br>    <span class="hljs-string">private</span> <span class="hljs-string">ScheduledExecutorService</span> <span class="hljs-string">scheduler;</span><br><br>    <span class="hljs-string">private</span> <span class="hljs-string">AuthCacheScheduler()</span> <span class="hljs-string">&#123;</span><br>        <span class="hljs-string">this.create();</span><br>    <span class="hljs-string">&#125;</span><br><br>    <span class="hljs-string">private</span> <span class="hljs-string">void</span> <span class="hljs-string">create()</span> <span class="hljs-string">&#123;</span><br>        <span class="hljs-string">this.shutdown();</span><br>        <span class="hljs-string">this.scheduler</span> <span class="hljs-string">=</span> <span class="hljs-string">new</span> <span class="hljs-string">ScheduledThreadPoolExecutor(10,</span> <span class="hljs-string">(r)</span> <span class="hljs-string">-&gt;</span> <span class="hljs-string">&#123;</span><br>            <span class="hljs-string">return</span> <span class="hljs-string">new</span> <span class="hljs-string">Thread(r,</span> <span class="hljs-string">String.format("JustAuth-Task-%s",</span> <span class="hljs-string">this.cacheTaskNumber.getAndIncrement()));</span><br>        <span class="hljs-string">&#125;);</span><br>    <span class="hljs-string">&#125;</span><br><br>    <span class="hljs-string">public</span> <span class="hljs-string">void</span> <span class="hljs-string">shutdown()</span> <span class="hljs-string">&#123;</span><br>        <span class="hljs-string">if</span> <span class="hljs-string">(null</span> <span class="hljs-string">!=</span> <span class="hljs-string">this.scheduler)</span> <span class="hljs-string">&#123;</span><br>            <span class="hljs-string">this.scheduler.shutdown();</span><br>        <span class="hljs-string">&#125;</span><br><br>    <span class="hljs-string">&#125;</span><br><br>    <span class="hljs-string">public</span> <span class="hljs-string">void</span> <span class="hljs-string">schedule(Runnable</span> <span class="hljs-string">task,</span> <span class="hljs-string">long</span> <span class="hljs-string">delay)</span> <span class="hljs-string">&#123;</span><br>        <span class="hljs-string">this.scheduler.scheduleAtFixedRate(task,</span> <span class="hljs-string">delay,</span> <span class="hljs-string">delay,</span> <span class="hljs-string">TimeUnit.MILLISECONDS);</span><br>    <span class="hljs-string">&#125;</span><br><span class="hljs-string">&#125;</span><br></code></pre></td></tr></table></figure>

<h4 id="Q-å¦‚ä½•åšåˆ°é€‚é…è‡ªæœ‰çš„-OAuth-æœåŠ¡ï¼Ÿ"><a href="#Q-å¦‚ä½•åšåˆ°é€‚é…è‡ªæœ‰çš„-OAuth-æœåŠ¡ï¼Ÿ" class="headerlink" title="Q: å¦‚ä½•åšåˆ°é€‚é…è‡ªæœ‰çš„ OAuth æœåŠ¡ï¼Ÿ"></a>Q: å¦‚ä½•åšåˆ°é€‚é…è‡ªæœ‰çš„ OAuth æœåŠ¡ï¼Ÿ</h4><p>å’Œä¸Šé¢å…¶ä»–å¹³å°çš„ä¸€æ ·ï¼Œå¯ä»¥è‡ªå®šä¹‰æ¥é€‚é…æ–°çš„å¹³å°ã€‚</p>
<ol>
<li><p>ç»§æ‰¿ AuthSourceï¼ŒåŠ å…¥ authorizeã€accessTokenã€userInfo åœ°å€</p>
</li>
<li><p>å®ç° AuthDefaultRequestï¼Œé‡å†™å‡ ä¸ªåŸºæœ¬çš„ oauth æœåŠ¡æ¥å£ï¼šgetAccessTokenã€getUserInfoã€authorizeã€‚</p>
</li>
<li><p>æµ‹è¯•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">AuthRequest authRequest = <span class="hljs-keyword">new</span> AuthMyGitlabRequest(AuthConfig.builder()<br>    .clientId(<span class="hljs-string">"63398e403231d4aa7e856cf5413620d536a876cb94e8d10ced0d3191b5d1d246"</span>)<br>    .clientSecret(<span class="hljs-string">"65b0eba68fff019e682e6755882a24dfdbf0a61be55de119cb8970320186c8eb"</span>)<br>    .redirectUri(<span class="hljs-string">"http://127.0.0.1:8443/oauth/callback/mygitlab"</span>)<br>    .build())<br></code></pre></td></tr></table></figure>

</li>
</ol>
<h4 id="Q-å¦‚ä½•æ”¯æŒè‡ªå®šä¹‰-Scopeï¼Ÿ"><a href="#Q-å¦‚ä½•æ”¯æŒè‡ªå®šä¹‰-Scopeï¼Ÿ" class="headerlink" title="Q: å¦‚ä½•æ”¯æŒè‡ªå®šä¹‰ Scopeï¼Ÿ"></a>Q: å¦‚ä½•æ”¯æŒè‡ªå®šä¹‰ Scopeï¼Ÿ</h4><p><a href="https://justauth.wiki/features/customize-scopes.html#%E8%87%AA%E5%AE%9A%E4%B9%89-scope-%E6%8E%A5%E5%85%A5-google-%E5%B9%B3%E5%8F%B0" target="_blank" rel="noopener">è‡ªå®šä¹‰-scope-æ¥å…¥-google-å¹³å°</a></p>
<p><code>scope</code> ç®€å•æ¥è¯´ï¼Œå°±æ˜¯ç”³è¯·å¾—åˆ°æŸä¸ªï¼ˆæŸäº›ï¼‰èŒƒå›´çš„èµ„æºï¼Œè¶…è¿‡æ­¤èŒƒå›´çš„èµ„æºé™åˆ¶è®¿é—®ã€‚</p>
<blockquote>
<p>Scope is a mechanism in OAuth 2.0 to limit an applicationâ€™s access to a userâ€™s account. An application can request one or more scopes, this information is then presented to the user in the consent screen, and the access token issued to the application will be limited to the scopes granted.</p>
<p>â€”â€” ä»¥ä¸Šå†…å®¹èŠ‚é€‰è‡ª<a href="https://oauth.net/" target="_blank" rel="noopener">oauth.net</a><a href="https://oauth.net/" target="_blank" rel="noopener"> (opens new window)</a></p>
</blockquote>
<p>æä¾› AuthScope ç»Ÿä¸€æ¥å£</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å„ä¸ªå¹³å° scope ç±»çš„ç»Ÿä¸€æ¥å£</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> yadong.zhang (yadong.zhang0415(a)gmail.com)</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> 1.0.0</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 1.15.7</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">AuthScope</span> </span>&#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å–å­—ç¬¦ä¸² &#123;<span class="hljs-doctag">@code</span> scope&#125;ï¼Œå¯¹åº”ä¸ºå„å¹³å°å®é™…ä½¿ç”¨çš„ &#123;<span class="hljs-doctag">@code</span> scope&#125;</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> String</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function">String <span class="hljs-title">getScope</span><span class="hljs-params">()</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆ¤æ–­å½“å‰ &#123;<span class="hljs-doctag">@code</span> scope&#125; æ˜¯å¦ä¸ºå„å¹³å°é»˜è®¤å¯ç”¨çš„</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> boolean</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">isDefault</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å„ä¸ªå¹³å°å®ç°æ­¤æ¥å£ï¼Œå¦‚ google</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Google å¹³å° OAuth æˆæƒèŒƒå›´</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> yadong.zhang (yadong.zhang0415(a)gmail.com)</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@version</span> 1.0.0</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 1.0.0</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Getter</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> AuthGoogleScope implements AuthScope &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * &#123;<span class="hljs-doctag">@code</span> scope&#125; å«ä¹‰ï¼Œä»¥&#123;<span class="hljs-doctag">@code</span> description&#125; ä¸ºå‡†</span><br><span class="hljs-comment">     */</span><br>    USER_OPENID(<span class="hljs-string">"openid"</span>, <span class="hljs-string">"Associate you with your personal info on Google"</span>, <span class="hljs-keyword">true</span>),<br>    USER_EMAIL(<span class="hljs-string">"email"</span>, <span class="hljs-string">"View your email address"</span>, <span class="hljs-keyword">true</span>),<br>    USER_PROFILE(<span class="hljs-string">"profile"</span>, <span class="hljs-string">"View your basic profile info"</span>, <span class="hljs-keyword">true</span>),<br>    USER_PHONENUMBERS_READ(<span class="hljs-string">"https://www.googleapis.com/auth/user.phonenumbers.read"</span>, <span class="hljs-string">"View your phone numbers"</span>, <span class="hljs-keyword">false</span>),<br>    USER_ORGANIZATION_READ(<span class="hljs-string">"https://www.googleapis.com/auth/user.organization.read"</span>, <span class="hljs-string">"See your education, work history and org info"</span>, <span class="hljs-keyword">false</span>),<br>    USER_GENDER_READ(<span class="hljs-string">"https://www.googleapis.com/auth/user.gender.read"</span>, <span class="hljs-string">"See your gender"</span>, <span class="hljs-keyword">false</span>),<br>    USER_EMAILS_READ(<span class="hljs-string">"https://www.googleapis.com/auth/user.emails.read"</span>, <span class="hljs-string">"View your email addresses"</span>, <span class="hljs-keyword">false</span>),<br><br>    USER_BIRTHDAY_READ(<span class="hljs-string">"https://www.googleapis.com/auth/user.birthday.read"</span>, <span class="hljs-string">"View your complete date of birth"</span>, <span class="hljs-keyword">false</span>)<br>    <span class="hljs-comment">// ...</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>ç»“åˆæµç¨‹å›¾æ¥è¯´ï¼Œï¼ˆAï¼‰è¿™é‡Œéœ€è¦å°† scope å¸¦è¿‡å»ï¼Œè¿›å…¥æˆæƒé¡µé¢ã€‚</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs routeros">+--------+                               +---------------+<br>|        |--(A)- Authorization Request -&gt;|  <span class="hljs-built_in"> Resource </span>   |<br>|        |                               |     Owner     |<br>|        |&lt;-(B)-- Authorization Grant ---|               |<br>|        |                               +---------------+<br>|        |<br>|        |                               +---------------+<br>|        |--(C)-- Authorization Grant --&gt;| Authorization |<br>|<span class="hljs-built_in"> Client </span>|                               |    <span class="hljs-built_in"> Server </span>   |<br>|        |&lt;-(D)----- Access Token -------|               |<br>|        |                               +---------------+<br>|        |<br>|        |                               +---------------+<br>|        |--(E)----- Access Token ------&gt;|   <span class="hljs-built_in"> Resource </span>  |<br>|        |                               |    <span class="hljs-built_in"> Server </span>   |<br>|        |&lt;-(F)--- Protected<span class="hljs-built_in"> Resource </span>---|               |<br>+--------+<br></code></pre></td></tr></table></figure>

<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sas">https://accounts.google.com/o/oauth2/v2/auth?response_type=code<span class="hljs-variable">&amp;client_id</span>=553817080137-d1pe3asc115tfgo74l8me92dhg4ro9k1.apps.googleusercontent.com<span class="hljs-variable">&amp;redirect_uri</span>=http://<span class="hljs-meta">x</span>.lyloou.com/oauth/google/callback<span class="hljs-variable">&amp;state</span>=e829a5725ce69cf1ed7918337caba839<span class="hljs-variable">&amp;access_type</span>=offline<span class="hljs-variable">&amp;scope</span>=openid email profile<span class="hljs-variable">&amp;prompt</span>=select_account<br></code></pre></td></tr></table></figure>

<p>æˆæƒé¡µé¢çš„é“¾æ¥æ˜¯é€šè¿‡ <code>AuthDefaultRequest.authorize</code> æ¥æ‹¼æ¥å¾—åˆ°çš„ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// AuthDefaultRequest.java</span><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è¿”å›å¸¦&#123;<span class="hljs-doctag">@code</span> state&#125;å‚æ•°çš„æˆæƒurlï¼Œæˆæƒå›è°ƒæ—¶ä¼šå¸¦ä¸Šè¿™ä¸ª&#123;<span class="hljs-doctag">@code</span> state&#125;</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> state state éªŒè¯æˆæƒæµç¨‹çš„å‚æ•°ï¼Œå¯ä»¥é˜²æ­¢csrf</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> è¿”å›æˆæƒåœ°å€</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@since</span> 1.9.3</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">authorize</span><span class="hljs-params">(String state)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> UrlBuilder.fromBaseUrl(<span class="hljs-keyword">super</span>.authorize(state))<br>            .queryParam(<span class="hljs-string">"access_type"</span>, <span class="hljs-string">"offline"</span>)<br>            .queryParam(<span class="hljs-string">"scope"</span>, <span class="hljs-keyword">this</span>.getScopes(<span class="hljs-string">" "</span>, <span class="hljs-keyword">false</span>, AuthScopeUtils.getDefaultScopes(AuthGoogleScope.values())))<br>            .queryParam(<span class="hljs-string">"prompt"</span>,<span class="hljs-string">"select_account"</span>)<br>            .build();<br>    &#125;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å–ä»¥ &#123;<span class="hljs-doctag">@code</span> separator&#125;åˆ†å‰²è¿‡åçš„ scope ä¿¡æ¯</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> separator     å¤šä¸ª &#123;<span class="hljs-doctag">@code</span> scope&#125; é—´çš„åˆ†éš”ç¬¦</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> encode        æ˜¯å¦ encode ç¼–ç </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> defaultScopes é»˜è®¤çš„ scopeï¼Œ å½“å®¢æˆ·ç«¯æ²¡æœ‰é…ç½® &#123;<span class="hljs-doctag">@code</span> scopes&#125; æ—¶å¯ç”¨</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> String</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@since</span> 1.16.7</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> String <span class="hljs-title">getScopes</span><span class="hljs-params">(String separator, <span class="hljs-keyword">boolean</span> encode, List&lt;String&gt; defaultScopes)</span> </span>&#123;<br>        List&lt;String&gt; scopes = config.getScopes();<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">null</span> == scopes || scopes.isEmpty()) &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">null</span> == defaultScopes || defaultScopes.isEmpty()) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;<br>            &#125;<br>            scopes = defaultScopes;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">null</span> == separator) &#123;<br>            <span class="hljs-comment">// é»˜è®¤ä¸ºç©ºæ ¼</span><br>            separator = <span class="hljs-string">" "</span>;<br>        &#125;<br>        String scopeStr = String.join(separator, scopes);<br>        <span class="hljs-keyword">return</span> encode ? UrlUtil.urlEncode(scopeStr) : scopeStr;<br>    &#125;<br></code></pre></td></tr></table></figure>

<p><code>getScopes</code> è¿™é‡Œçš„é€»è¾‘æ˜¯ï¼Œå¦‚æœæ²¡æœ‰ä¼ å…¥ scope å‚æ•°ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨é»˜è®¤çš„ scope å‚æ•°ï¼Œå³<code>openid email profile</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">USER_OPENID(<span class="hljs-string">"openid"</span>, <span class="hljs-string">"Associate you with your personal info on Google"</span>, <span class="hljs-keyword">true</span>),<br>USER_EMAIL(<span class="hljs-string">"email"</span>, <span class="hljs-string">"View your email address"</span>, <span class="hljs-keyword">true</span>),<br>USER_PROFILE(<span class="hljs-string">"profile"</span>, <span class="hljs-string">"View your basic profile info"</span>, <span class="hljs-keyword">true</span>),<br></code></pre></td></tr></table></figure>

<p>æ’æ›²ï¼šå¦‚æœä½ æŠŠ email å’Œ profile å–æ¶ˆæ‰ï¼Œè·å–åˆ°ç”¨æˆ·ä¿¡æ¯æ—¶ä¼šå‘ç°å°‘äº† email,profile è¿™äº›ä¿¡æ¯</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-comment">// scope=openid</span><br>&#123;<br>  <span class="hljs-attr">"code"</span>: <span class="hljs-number">2000</span>,<br>  <span class="hljs-attr">"msg"</span>: <span class="hljs-literal">null</span>,<br>  <span class="hljs-attr">"data"</span>: &#123;<br>    <span class="hljs-attr">"uuid"</span>: <span class="hljs-string">"113911973270419053931"</span>,<br>    <span class="hljs-attr">"username"</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">"nickname"</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">"avatar"</span>: <span class="hljs-string">"https://lh3.googleusercontent.com/a-/AOh14GgncI8eYK_uG119BDclub5LNGDn57G_GI4OLZeOBA=s96-c"</span>,<br>    <span class="hljs-attr">"blog"</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">"company"</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">"location"</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">"email"</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">"remark"</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">"gender"</span>: <span class="hljs-string">"UNKNOWN"</span>,<br>    <span class="hljs-attr">"source"</span>: <span class="hljs-string">"GOOGLE"</span>,<br>    <span class="hljs-attr">"token"</span>: &#123;<br>      <span class="hljs-attr">"accessToken"</span>: <span class="hljs-string">"ya29.a0ARrdaM-dddddd-MPjpVj6xJAJP0zZFb396tpmi6BkS_Uom1G7DGTvSaWdJwwOzCXC5Bus-xQjq9JdGfNKWylhl029LMtuyZVT7lKzquGvUFePmellmRoY2Or6RgjS-TwKHzSviQoqEFBcYlQ"</span>,<br>      <span class="hljs-attr">"expireIn"</span>: <span class="hljs-number">3592</span>,<br>      <span class="hljs-attr">"refreshToken"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"refreshTokenExpireIn"</span>: <span class="hljs-number">0</span>,<br>      <span class="hljs-attr">"uid"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"openId"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"accessCode"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"unionId"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"scope"</span>: <span class="hljs-string">"openid"</span>,<br>      <span class="hljs-attr">"tokenType"</span>: <span class="hljs-string">"Bearer"</span>,<br>      <span class="hljs-attr">"idToken"</span>: <span class="hljs-string">"eyJhbGciOiJSUzI1NiIsImtpZCI6ImI2ZjhkNTVkYTUzNGVhOTFjYjJjYjAwZTFhZjRlOGUwY2RlY2E5M2QiLCJ0eXAiOiJKV1QifQ.dddddd.yYUcU9VMwrF3vGXfmR4bsJDeQSjl_msow9eCARiV8HYIyjWDyZUM0ihOqxQzunWUT0W3nRVWxFw4oeN9bhZxIU9jBpW600eJRyDZ6BgJs0QEmC4sjJ4rWPp_P6OFo6b4HEM9Cl5i4ix-cJV18-4BxWhM6WbuC09F3a5RVvp7YGzYhMDRK4fecDpy-7q5wFZws3oYOrjCK5rVu4lioLMTJHCV-THbWImZTrEiuiLxw6onvKwhDa2FfLGbO3tei0EoVTvxJJwi18K-5TzcNySb8yBA-NYTXmlLZ9iWb7NNa7IXqKI1qt0VYm7xUUY4r3G14tZKU6JKkuz07RVx-4zxMw"</span>,<br>      <span class="hljs-attr">"macAlgorithm"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"macKey"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"code"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"oauthToken"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"oauthTokenSecret"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"userId"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"screenName"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"oauthCallbackConfirmed"</span>: <span class="hljs-literal">null</span><br>    &#125;,<br>    <span class="hljs-attr">"rawUserInfo"</span>: &#123;<br>      <span class="hljs-attr">"sub"</span>: <span class="hljs-string">"ddd"</span>,<br>      <span class="hljs-attr">"picture"</span>: <span class="hljs-string">"https://lh3.googleusercontent.com/a-/AOh14GgncI8eYK_uG119BDclub5LNGDn57G_GI4OLZeOBA=s96-c"</span><br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-comment">// scope=openid email profile</span><br>&#123;<br>  <span class="hljs-attr">"code"</span>: <span class="hljs-number">2000</span>,<br>  <span class="hljs-attr">"msg"</span>: <span class="hljs-literal">null</span>,<br>  <span class="hljs-attr">"data"</span>: &#123;<br>    <span class="hljs-attr">"uuid"</span>: <span class="hljs-string">"113911973270419053931"</span>,<br>    <span class="hljs-attr">"username"</span>: <span class="hljs-string">"lyloou6@gmail.com"</span>,<br>    <span class="hljs-attr">"nickname"</span>: <span class="hljs-string">"Lou"</span>,<br>    <span class="hljs-attr">"avatar"</span>: <span class="hljs-string">"https://lh3.googleusercontent.com/a-/AOh14GgncI8eYK_uG119BDclub5LNGDn57G_GI4OLZeOBA=s96-c"</span>,<br>    <span class="hljs-attr">"blog"</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">"company"</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">"location"</span>: <span class="hljs-string">"zh-CN"</span>,<br>    <span class="hljs-attr">"email"</span>: <span class="hljs-string">"lyloou6@gmail.com"</span>,<br>    <span class="hljs-attr">"remark"</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-attr">"gender"</span>: <span class="hljs-string">"UNKNOWN"</span>,<br>    <span class="hljs-attr">"source"</span>: <span class="hljs-string">"GOOGLE"</span>,<br>    <span class="hljs-attr">"token"</span>: &#123;<br>      <span class="hljs-attr">"accessToken"</span>: <span class="hljs-string">"ya29.dd-dddd-eplbTCCWb55DHRZeAGDqDvk5RADufWREONGgKhdtCLa3yWKp4TxTJsyPi2EXYhgmMqV4yVV-NX6swbc38hMXKKGzsTnW4UVaiSOklQ-C1B_af"</span>,<br>      <span class="hljs-attr">"expireIn"</span>: <span class="hljs-number">3599</span>,<br>      <span class="hljs-attr">"refreshToken"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"refreshTokenExpireIn"</span>: <span class="hljs-number">0</span>,<br>      <span class="hljs-attr">"uid"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"openId"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"accessCode"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"unionId"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"scope"</span>: <span class="hljs-string">"openid https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email"</span>,<br>      <span class="hljs-attr">"tokenType"</span>: <span class="hljs-string">"Bearer"</span>,<br>      <span class="hljs-attr">"idToken"</span>: <span class="hljs-string">"dddddddddd"</span>,<br>      <span class="hljs-attr">"macAlgorithm"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"macKey"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"code"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"oauthToken"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"oauthTokenSecret"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"userId"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"screenName"</span>: <span class="hljs-literal">null</span>,<br>      <span class="hljs-attr">"oauthCallbackConfirmed"</span>: <span class="hljs-literal">null</span><br>    &#125;,<br>    <span class="hljs-attr">"rawUserInfo"</span>: &#123;<br>      <span class="hljs-attr">"sub"</span>: <span class="hljs-string">"113911973270419053931"</span>,<br>      <span class="hljs-attr">"email_verified"</span>: <span class="hljs-literal">true</span>,<br>      <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Lou"</span>,<br>      <span class="hljs-attr">"given_name"</span>: <span class="hljs-string">"Lou"</span>,<br>      <span class="hljs-attr">"locale"</span>: <span class="hljs-string">"zh-CN"</span>,<br>      <span class="hljs-attr">"picture"</span>: <span class="hljs-string">"https://lh3.googleusercontent.com/a-/AOh14GgncI8eYK_uG119BDclub5LNGDn57G_GI4OLZeOBA=s96-c"</span>,<br>      <span class="hljs-attr">"email"</span>: <span class="hljs-string">"lyloou6@gmail.com"</span><br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/lyloou/img/develop/justauth%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0-2021-07-02-10-50-48.png" alt="justauthæºç å­¦ä¹ -2021-07-02-10-50-48"><br>åé¢è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œå¸¦ä¸Š accessToken æ¥å°±å¯ä»¥è·å–äº†ã€‚</p>
<h4 id="Q-http-å·¥å…·å¦‚ä½•è§£è€¦ï¼Œå¯ä»¥å°†é€‰æ‹©æƒäº¤ç»™å¼€å‘è€…ï¼Ÿ"><a href="#Q-http-å·¥å…·å¦‚ä½•è§£è€¦ï¼Œå¯ä»¥å°†é€‰æ‹©æƒäº¤ç»™å¼€å‘è€…ï¼Ÿ" class="headerlink" title="Q: http å·¥å…·å¦‚ä½•è§£è€¦ï¼Œå¯ä»¥å°†é€‰æ‹©æƒäº¤ç»™å¼€å‘è€…ï¼Ÿ"></a>Q: http å·¥å…·å¦‚ä½•è§£è€¦ï¼Œå¯ä»¥å°†é€‰æ‹©æƒäº¤ç»™å¼€å‘è€…ï¼Ÿ</h4><p>ä½œè€…å¼•å…¥äº†è‡ªå·±å®ç°çš„ <code>simple-http</code> å·¥å…·åŒ… <a href="https://github.com/xkcoding/simple-http" target="_blank" rel="noopener">xkcoding/simple-http: æŠ½å–ä¸€ä¸ªç®€å• HTTP çš„é€šç”¨æ¥å£ï¼Œåº•å±‚å®ç°æ ¹æ®å…·ä½“å¼•å…¥ä¾èµ–æŒ‡å®šã€‚</a></p>
<p>ä» <code>AuthGithubRequest#getUserInfo</code> å¼€å§‹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> AuthUser <span class="hljs-title">getUserInfo</span><span class="hljs-params">(AuthToken authToken)</span> </span>&#123;<br>    HttpHeader header = <span class="hljs-keyword">new</span> HttpHeader();<br>    header.add(<span class="hljs-string">"Authorization"</span>, <span class="hljs-string">"token "</span> + authToken.getAccessToken());<br>    String response = (<span class="hljs-keyword">new</span> HttpUtils(<span class="hljs-keyword">this</span>.config.getHttpConfig())).get(UrlBuilder.fromBaseUrl(<span class="hljs-keyword">this</span>.source.userInfo()).build(), (Map)<span class="hljs-keyword">null</span>, header, <span class="hljs-keyword">false</span>);<br>    JSONObject object = JSONObject.parseObject(response);<br>    <span class="hljs-keyword">this</span>.checkResponse(object.containsKey(<span class="hljs-string">"error"</span>), object.getString(<span class="hljs-string">"error_description"</span>));<br>    <span class="hljs-keyword">return</span> AuthUser.builder().rawUserInfo(object).uuid(object.getString(<span class="hljs-string">"id"</span>)).username(object.getString(<span class="hljs-string">"login"</span>)).avatar(object.getString(<span class="hljs-string">"avatar_url"</span>)).blog(object.getString(<span class="hljs-string">"blog"</span>)).nickname(object.getString(<span class="hljs-string">"name"</span>)).company(object.getString(<span class="hljs-string">"company"</span>)).location(object.getString(<span class="hljs-string">"location"</span>)).email(object.getString(<span class="hljs-string">"email"</span>)).remark(object.getString(<span class="hljs-string">"bio"</span>)).gender(AuthUserGender.UNKNOWN).token(authToken).source(<span class="hljs-keyword">this</span>.source.toString()).build();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>è¿™é‡Œå®ä¾‹åŒ–äº†ä¸€ä¸ª HttpUtils å·¥å…·ç±» <code>new HttpUtils(this.config.getHttpConfig())</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HttpUtils</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">HttpUtils</span><span class="hljs-params">(HttpConfig config)</span> </span>&#123;<br>        HttpUtil.setConfig(config);<br>    &#125;<br>    <span class="hljs-comment">// ...</span><br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HttpUtil</span></span>&#123;<br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setConfig</span><span class="hljs-params">(HttpConfig httpConfig)</span> </span>&#123;<br>		checkHttpNotNull(proxy);<br>		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">null</span> == httpConfig) &#123;<br>			httpConfig = HttpConfig.builder().timeout(Constants.DEFAULT_TIMEOUT).build();<br>		&#125;<br>		proxy.setHttpConfig(httpConfig);<br>	&#125;<br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">checkHttpNotNull</span><span class="hljs-params">(Http proxy)</span> </span>&#123;<br>		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">null</span> == proxy) &#123;<br>			selectHttpProxy();<br>		&#125;<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ° <code>selectHttpProxy()</code>è¿™é‡Œæ˜¯å…³é”®ï¼Œé€šè¿‡ <code>ClassUtil.isPresent</code>çš„æ–¹å¼ï¼ˆå³<code>Class.forName</code>ï¼‰æ¥ç¡®å®š class æ˜¯å¦å¯ä»¥è¢«åŠ è½½ï¼Œä»ä¸Šåˆ°ä¸‹ï¼Œå¦‚æœå¯ä»¥è¢«åŠ è½½ï¼Œå°±ä½œä¸º http çš„å…·ä½“ä»£ç†ã€‚ï¼ˆæ‰€ä»¥å¼•å…¥äº†ç›¸å…³çš„ http ä¾èµ–ï¼Œ<code>HttpUtils</code> å°±å¯ä»¥ç›´æ¥æ‹¿æ¥ä½¿ç”¨äº†ï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HttpUtil</span> </span>&#123;<br>	<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> AbstractHttp proxy;<br><br>	<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">selectHttpProxy</span><span class="hljs-params">()</span> </span>&#123;<br>		AbstractHttp defaultProxy = <span class="hljs-keyword">null</span>;<br>		ClassLoader classLoader = HttpUtil<span class="hljs-class">.<span class="hljs-keyword">class</span>.<span class="hljs-title">getClassLoader</span>()</span>;<br>		<span class="hljs-comment">// åŸºäº java 11 HttpClient</span><br>		<span class="hljs-keyword">if</span> (ClassUtil.isPresent(<span class="hljs-string">"java.net.http.HttpClient"</span>, classLoader)) &#123;<br>			defaultProxy = getHttpProxy(com.xkcoding.http.support.java11.HttpClientImpl<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span>;<br>		&#125;<br>		<span class="hljs-comment">// åŸºäº okhttp3</span><br>		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">null</span> == defaultProxy &amp;&amp; ClassUtil.isPresent(<span class="hljs-string">"okhttp3.OkHttpClient"</span>, classLoader)) &#123;<br>			defaultProxy = getHttpProxy(com.xkcoding.http.support.okhttp3.OkHttp3Impl<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span>;<br>		&#125;<br>		<span class="hljs-comment">// åŸºäº httpclient</span><br>		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">null</span> == defaultProxy &amp;&amp; ClassUtil.isPresent(<span class="hljs-string">"org.apache.http.impl.client.HttpClients"</span>, classLoader)) &#123;<br>			defaultProxy = getHttpProxy(com.xkcoding.http.support.httpclient.HttpClientImpl<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span>;<br>		&#125;<br>		<span class="hljs-comment">// åŸºäº hutool</span><br>		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">null</span> == defaultProxy &amp;&amp; ClassUtil.isPresent(<span class="hljs-string">"cn.hutool.http.HttpRequest"</span>, classLoader)) &#123;<br>			defaultProxy = getHttpProxy(com.xkcoding.http.support.hutool.HutoolImpl<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span>;<br>		&#125;<br><br>		<span class="hljs-keyword">if</span> (defaultProxy == <span class="hljs-keyword">null</span>) &#123;<br>			<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> SimpleHttpException(<span class="hljs-string">"Has no HttpImpl defined in environment!"</span>);<br>		&#125;<br><br>		proxy = defaultProxy;<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¦‚ä¸‹å›¾ï¼Œæ˜¯ <code>simpleHttp</code> é»˜è®¤æ”¯æŒçš„ Http å·¥å…·ã€‚</p>
<p><img src="http://cdn.lyloou.com/img/20210625112103.png" alt="image-20210625112056585"></p>
<p>ä¹Ÿå¯ä»¥è‡ªå·±ç»§æ‰¿ <code>AbstractHttp</code>ï¼Œç„¶åè°ƒç”¨ <code>HttpUtil#setHttp(AbstractHttp http)</code> æ–¹æ³•æ¥æ¥å…¥è‡ªå·±å®ç°çš„ http å·¥å…·ã€‚</p>
<p>æ‰€æœ‰å®ç° AbstractHttp å’Œ Http çš„ç±»ï¼Œéœ€è¦è‡ªå·±å®ç° ä¸€ç³»åˆ—çš„<code>get</code>ã€ <code>post</code> æ–¹æ³•ï¼ˆå³å°è£…ï¼‰ã€‚è¿è¡Œæ—¶é€šè¿‡é¢å‘å¯¹è±¡ä¸­çš„å¤šæ€æ¥å†³å®šå…·ä½“çš„å®ç°è€…ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://lyloou.github.io/business/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/assets/images/avatar.png">
      <meta itemprop="name" content="lyloou">
      <meta itemprop="description" content="/* Better than last best */">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lyloou">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/business/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/" class="post-title-link" itemprop="url">åˆ†å¸ƒå¼äº‹åŠ¡</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-06-17 10:23:30" itemprop="dateCreated datePublished" datetime="2021-06-17T10:23:30+08:00">2021-06-17</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="ï¼ˆATã€TCCã€Sagaã€XAï¼‰æ¨¡å¼åˆ†æ"><a href="#ï¼ˆATã€TCCã€Sagaã€XAï¼‰æ¨¡å¼åˆ†æ" class="headerlink" title="ï¼ˆATã€TCCã€Sagaã€XAï¼‰æ¨¡å¼åˆ†æ"></a>ï¼ˆATã€TCCã€Sagaã€XAï¼‰æ¨¡å¼åˆ†æ</h3><blockquote>
<p>å››ç§åˆ†å¸ƒå¼äº‹åŠ¡æ¨¡å¼ï¼Œåˆ†åˆ«åœ¨ä¸åŒçš„æ—¶é—´è¢«æå‡ºï¼Œæ¯ç§æ¨¡å¼éƒ½æœ‰å®ƒçš„é€‚ç”¨åœºæ™¯</p>
<ul>
<li>AT æ¨¡å¼æ˜¯æ— ä¾µå…¥çš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆï¼Œé€‚ç”¨äºä¸å¸Œæœ›å¯¹ä¸šåŠ¡è¿›è¡Œæ”¹é€ çš„åœºæ™¯ï¼Œå‡ ä¹ 0 å­¦ä¹ æˆæœ¬ã€‚</li>
<li>TCC æ¨¡å¼æ˜¯é«˜æ€§èƒ½åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆï¼Œé€‚ç”¨äºæ ¸å¿ƒç³»ç»Ÿç­‰å¯¹æ€§èƒ½æœ‰å¾ˆé«˜è¦æ±‚çš„åœºæ™¯ã€‚</li>
<li>Saga æ¨¡å¼æ˜¯é•¿äº‹åŠ¡è§£å†³æ–¹æ¡ˆï¼Œé€‚ç”¨äºä¸šåŠ¡æµç¨‹é•¿ä¸”éœ€è¦ä¿è¯äº‹åŠ¡æœ€ç»ˆä¸€è‡´æ€§çš„ä¸šåŠ¡ç³»ç»Ÿï¼ŒSaga æ¨¡å¼ä¸€é˜¶æ®µå°±ä¼šæäº¤æœ¬åœ°äº‹åŠ¡ï¼Œæ— é”ï¼Œé•¿æµç¨‹æƒ…å†µä¸‹å¯ä»¥ä¿è¯æ€§èƒ½ï¼Œå¤šç”¨äºæ¸ é“å±‚ã€é›†æˆå±‚ä¸šåŠ¡ç³»ç»Ÿã€‚äº‹åŠ¡å‚ä¸è€…å¯èƒ½æ˜¯å…¶å®ƒå…¬å¸çš„æœåŠ¡æˆ–è€…æ˜¯é—ç•™ç³»ç»Ÿçš„æœåŠ¡ï¼Œæ— æ³•è¿›è¡Œæ”¹é€ å’Œæä¾› TCC è¦æ±‚çš„æ¥å£ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Saga æ¨¡å¼ã€‚</li>
<li>XA æ¨¡å¼æ˜¯åˆ†å¸ƒå¼å¼ºä¸€è‡´æ€§çš„è§£å†³æ–¹æ¡ˆï¼Œä½†æ€§èƒ½ä½è€Œä½¿ç”¨è¾ƒå°‘ã€‚</li>
</ul>
</blockquote>
<ul>
<li><p><a href="https://zhuanlan.zhihu.com/p/78599954" target="_blank" rel="noopener">åˆ†å¸ƒå¼äº‹åŠ¡çš„ 4 ç§æ¨¡å¼ - çŸ¥ä¹</a></p>
</li>
<li><p><a href="https://juejin.cn/post/6844903913691283469" target="_blank" rel="noopener">åˆ†å¸ƒå¼äº‹åŠ¡ Seata Saga æ¨¡å¼é¦–ç§€ä»¥åŠä¸‰ç§æ¨¡å¼è¯¦è§£ | Meetup#3 å›é¡¾</a></p>
</li>
<li><p><a href="https://tech.antfin.com/community/activities/779/review/901" target="_blank" rel="noopener">åˆ†å¸ƒå¼äº‹åŠ¡ Seata ä¸‰ç§æ¨¡å¼è¯¦è§£ - æ´»åŠ¨å›é¡¾</a></p>
</li>
<li><p><a href="http://seata.io/zh-cn/docs/overview/what-is-seata.html" target="_blank" rel="noopener">Seata æ˜¯ä»€ä¹ˆ</a></p>
</li>
</ul>
<blockquote>
<p>ç”±äº Saga ä¸ä¿è¯éš”ç¦»æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ä¸šåŠ¡è®¾è®¡çš„æ—¶å€™éœ€è¦åšåˆ°â€œå®å¯é•¿æ¬¾ï¼Œä¸å¯çŸ­æ¬¾â€çš„åŸåˆ™ï¼Œé•¿æ¬¾æ˜¯æŒ‡åœ¨å‡ºç°å·®é”™çš„æ—¶å€™ç«™åœ¨æˆ‘æ–¹çš„è§’åº¦é’±å¤šäº†çš„æƒ…å†µï¼Œé’±å°‘äº†åˆ™æ˜¯çŸ­æ¬¾ï¼Œå› ä¸ºå¦‚æœé•¿æ¬¾å¯ä»¥ç»™å®¢æˆ·é€€æ¬¾ï¼Œè€ŒçŸ­æ¬¾åˆ™å¯èƒ½é’±è¿½ä¸å›æ¥äº†ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ä¸šåŠ¡è®¾è®¡çš„æ—¶å€™ï¼Œä¸€å®šæ˜¯å…ˆæ‰£å®¢æˆ·å¸å†å…¥å¸ï¼Œå¦‚æœå› ä¸ºéš”ç¦»æ€§é—®é¢˜é€ æˆè¦†ç›–æ›´æ–°ï¼Œä¹Ÿä¸ä¼šå‡ºç°é’±å°‘äº†çš„æƒ…å†µã€‚</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://lyloou.github.io/mq/RocketMQ%E5%AE%9E%E7%8E%B0%E7%A7%92%E6%9D%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/assets/images/avatar.png">
      <meta itemprop="name" content="lyloou">
      <meta itemprop="description" content="/* Better than last best */">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lyloou">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/mq/RocketMQ%E5%AE%9E%E7%8E%B0%E7%A7%92%E6%9D%80/" class="post-title-link" itemprop="url">RocketMQå®ç°ç§’æ€</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-06-16 11:19:15" itemprop="dateCreated datePublished" datetime="2021-06-16T11:19:15+08:00">2021-06-16</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="è½¯ä»¶ç¯å¢ƒ"><a href="#è½¯ä»¶ç¯å¢ƒ" class="headerlink" title="è½¯ä»¶ç¯å¢ƒ"></a>è½¯ä»¶ç¯å¢ƒ</h2><p>virtualbox: 6.1<br>centos: 7.0<br>jdk: 1.8<br>rocketmq: <a href="https://archive.apache.org/dist/rocketmq/4.5.1/rocketmq-all-4.5.1-bin-release.zip" target="_blank" rel="noopener">https://archive.apache.org/dist/rocketmq/4.5.1/rocketmq-all-4.5.1-bin-release.zip</a><br>rocketmq-console: <a href="https://github.com/apache/rocketmq-externals/tree/release-rocketmq-console-1.0.0" target="_blank" rel="noopener">https://github.com/apache/rocketmq-externals/tree/release-rocketmq-console-1.0.0</a><br>redis: Redis-x64-5.0.10<br>mysql: 5.6</p>
<h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># ä¿®æ”¹ä¸»æœºå</span><br>hostnamectl <span class="hljs-built_in">set</span>-hostname node1.com<br>hostnamectl <span class="hljs-built_in">set</span>-hostname node2.com<br>hostnamectl <span class="hljs-built_in">set</span>-hostname node3.com<br>hostnamectl <span class="hljs-built_in">set</span>-hostname node4.com<br><br><span class="hljs-comment"># åˆ·æ–°ç»ˆç«¯</span><br>bash<br><span class="hljs-comment"># æŸ¥çœ‹æ˜¯å¦ç”Ÿæ•ˆ</span><br>hostname<br><br><span class="hljs-comment"># ä¿®æ”¹ç½‘ç»œä¸ºå…·ä½“æŸä¸ªip</span><br>vi /etc/sysconfig/network-scripts/ifcfg-ens0s8<br>TYPE=Ethernet<br>BOOTPROTO=none<br>DEFROUTE=yes<br>PEERDNS=yes<br>PEERROUTES=yes<br>IPV4_FAILURE_FATAL=no<br>IPV6INIT=yes<br>IPV6_AUTOCONF=yes<br>IPV6_DEFROUTE=yes<br>IPV6_PEERDNS=yes<br>IPV6_PEERROUTES=yes<br>IPV6_FAILURE_FATAL=no<br>NAME=enp0s8<br>UUID=ed6c068c-149c-4678-8a13-d6e34a5d50c9<br>DEVICE=enp0s8<br>ONBOOT=yes<br>IPADDR=192.168.56.11<br>GATEWAY=192.168.56.1<br>DNS1=10.0.2.2<br>DNS2=8.8.8.8<br><br><span class="hljs-comment"># é‡å¯ç½‘ç»œ</span><br>systemctl restart network<br></code></pre></td></tr></table></figure>

<h2 id="ä¿®æ”¹å’ŒåŒæ­¥-hosts"><a href="#ä¿®æ”¹å’ŒåŒæ­¥-hosts" class="headerlink" title="ä¿®æ”¹å’ŒåŒæ­¥ hosts"></a>ä¿®æ”¹å’ŒåŒæ­¥ hosts</h2><ol>
<li>ä¿®æ”¹ node1.com</li>
</ol>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">192.168.56.11</span> node1.com<br><span class="hljs-number">192.168.56.12</span> node2.com<br><span class="hljs-number">192.168.56.13</span> node3.com<br><span class="hljs-number">192.168.56.14</span> node4.com<br></code></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">scp /etc/hosts root@node1.com:/etc/hosts<br>scp /etc/hosts root@node2.com:/etc/hosts<br>scp /etc/hosts root@node3.com:/etc/hosts<br>scp /etc/hosts root@node4.com:/etc/hosts<br></code></pre></td></tr></table></figure>

<h2 id="å¯åŠ¨-RocketMQ"><a href="#å¯åŠ¨-RocketMQ" class="headerlink" title="å¯åŠ¨ RocketMQ"></a>å¯åŠ¨ RocketMQ</h2><p><strong>å¯åŠ¨ nameserver</strong><br>node1 æ“ä½œï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">/root/c/rocketmq-all-4.5.1-bin-release/bin/mqnamesrv<br></code></pre></td></tr></table></figure>

<p>node2 æ“ä½œï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">/root/c/rocketmq-all-4.5.1-bin-release/bin/mqnamesrv<br></code></pre></td></tr></table></figure>

<p><strong>å¯åŠ¨ broker</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@node1 ~]#<br>/root/c/rocketmq-all-4.5.1-bin-release/bin/mqbroker -n "node1.com:9876;node2.com:9876" -c /root/c/rocketmq-all-4.5.1-bin-release/conf/2m-2s-sync/broker-a.properties<br>[root@node2 ~]#<br>/root/c/rocketmq-all-4.5.1-bin-release/bin/mqbroker -n "node1.com:9876;node2.com:9876" -c /root/c/rocketmq-all-4.5.1-bin-release/conf/2m-2s-sync/broker-b.properties<br>[root@node3 ~]#<br>/root/c/rocketmq-all-4.5.1-bin-release/bin/mqbroker -n "node1.com:9876;node2.com:9876" -c /root/c/rocketmq-all-4.5.1-bin-release/conf/2m-2s-sync/broker-a-s.properties<br>[root@node4 ~]#<br>/root/c/rocketmq-all-4.5.1-bin-release/bin/mqbroker -n "node1.com:9876;node2.com:9876" -c /root/c/rocketmq-all-4.5.1-bin-release/conf/2m-2s-sync/broker-b-s.properties<br></code></pre></td></tr></table></figure>

<p><strong>å¯åŠ¨æ§åˆ¶å°</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> /root/c/rocketmq-externals-rocketmq-console-1.0.0<br>mvn clean package -Dmaven.test.skip<br>java -jar /root/c/rocketmq-externals-rocketmq-console-1.0.0/rocketmq-console/target/rocketmq-console-ng-1.0.0.jar<br></code></pre></td></tr></table></figure>

<h2 id="åˆ†å¸ƒå¼äº‹åŠ¡"><a href="#åˆ†å¸ƒå¼äº‹åŠ¡" class="headerlink" title="åˆ†å¸ƒå¼äº‹åŠ¡"></a>åˆ†å¸ƒå¼äº‹åŠ¡</h2><p>é€šè¿‡åˆ†å¸ƒå¼äº‹åŠ¡æ¥ä¿è¯ä¸€è‡´æ€§ï¼ˆæ•°æ®åº“ä¸ MQ çš„ä¸€è‡´æ€§ï¼‰</p>
<p><img src="http://cdn.lyloou.com/img/RocketMQ-2021-06-15-11-33-52.png" alt="RocketMQ-2021-06-15-11-33-52"></p>
<blockquote>
<p>RocketMQ äº‹åŠ¡æ¶ˆæ¯çš„å®ç°åŸç†å°±æ˜¯åŸºäºä¸¤é˜¶æ®µæäº¤å’Œäº‹åŠ¡çŠ¶æ€å›æŸ¥ï¼Œæ¥å†³å®šæ¶ˆæ¯æœ€ç»ˆæ˜¯æäº¤è¿˜æ˜¯å›æ»šã€‚</p>
</blockquote>
<ul>
<li><a href="https://juejin.cn/post/6844904099993878536" target="_blank" rel="noopener">åŸºäº RocketMQ åˆ†å¸ƒå¼äº‹åŠ¡ - å®Œæ•´ç¤ºä¾‹</a></li>
</ul>
<h2 id="æ¼”ç¤º"><a href="#æ¼”ç¤º" class="headerlink" title="æ¼”ç¤º"></a>æ¼”ç¤º</h2><p><strong>ä¸‹å•é¡µ</strong><br><a href="http://localhost:8081/order" target="_blank" rel="noopener">http://localhost:8081/order</a><br><img src="http://cdn.lyloou.com/img/RocketMQ%E5%AE%9E%E7%8E%B0%E7%A7%92%E6%9D%80-2021-06-16-11-09-12.png" alt="RocketMQå®ç°ç§’æ€-2021-06-16-11-09-12"></p>
<p><strong>æ”¯ä»˜é¡µ</strong><br><a href="http://localhost:8081/pay" target="_blank" rel="noopener">http://localhost:8081/pay</a><br><img src="http://cdn.lyloou.com/img/RocketMQ%E5%AE%9E%E7%8E%B0%E7%A7%92%E6%9D%80-2021-06-16-11-09-30.png" alt="RocketMQå®ç°ç§’æ€-2021-06-16-11-09-30"></p>
<p><strong>æ‰¹é‡è´­ä¹°</strong><br><img src="http://cdn.lyloou.com/img/RocketMQ%E5%AE%9E%E7%8E%B0%E7%A7%92%E6%9D%80-2021-06-16-11-14-49.png" alt="RocketMQå®ç°ç§’æ€-2021-06-16-11-14-49"><br>ä¸ä¼šå¯¼è‡´åº“å­˜è¶…å–<br><img src="http://cdn.lyloou.com/img/RocketMQ%E5%AE%9E%E7%8E%B0%E7%A7%92%E6%9D%80-2021-06-16-11-10-18.png" alt="RocketMQå®ç°ç§’æ€-2021-06-16-11-10-18"></p>
<h2 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h2><p><a href="https://gitee.com/lyloou/practice-rocketmq-seckill/tree/feature_transaction/" target="_blank" rel="noopener">https://gitee.com/lyloou/practice-rocketmq-seckill/tree/feature_transaction/</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://lyloou.github.io/%E7%AE%97%E6%B3%95/%E6%95%B0%E5%AD%97%E5%8F%AA%E5%87%BA%E7%8E%B0%E4%B8%80%E6%AC%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/assets/images/avatar.png">
      <meta itemprop="name" content="lyloou">
      <meta itemprop="description" content="/* Better than last best */">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lyloou">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/%E7%AE%97%E6%B3%95/%E6%95%B0%E5%AD%97%E5%8F%AA%E5%87%BA%E7%8E%B0%E4%B8%80%E6%AC%A1/" class="post-title-link" itemprop="url">ã€ç®—æ³•ã€‘æ•°å­—åªå‡ºç°ä¸€æ¬¡æˆ–ä¸¤æ¬¡</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-06-02 14:41:05" itemprop="dateCreated datePublished" datetime="2021-06-02T14:41:05+08:00">2021-06-02</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="åˆ¤æ–­æ•°ç»„ä¸­çš„æ‰€æœ‰çš„æ•°å­—æ˜¯å¦åªå‡ºç°ä¸€æ¬¡ã€‚"><a href="#åˆ¤æ–­æ•°ç»„ä¸­çš„æ‰€æœ‰çš„æ•°å­—æ˜¯å¦åªå‡ºç°ä¸€æ¬¡ã€‚" class="headerlink" title="åˆ¤æ–­æ•°ç»„ä¸­çš„æ‰€æœ‰çš„æ•°å­—æ˜¯å¦åªå‡ºç°ä¸€æ¬¡ã€‚"></a>åˆ¤æ–­æ•°ç»„ä¸­çš„æ‰€æœ‰çš„æ•°å­—æ˜¯å¦åªå‡ºç°ä¸€æ¬¡ã€‚</h2><p>ç»™å®šä¸€ä¸ªæ•°ç»„ arrayï¼Œåˆ¤æ–­æ•°ç»„ array ä¸­æ˜¯å¦æ‰€æœ‰çš„æ•°å­—åªå‡ºç°ä¸€æ¬¡ã€‚<br>ä¾‹å¦‚ï¼Œ<code>arr = {1, 2, 3}</code>ï¼Œè¾“å‡º <code>YES</code>ã€‚<br>åˆå¦‚ï¼Œ<code>arr = {1, 2, 1}</code>ï¼Œè¾“å‡º <code>NO</code>ã€‚<br>çº¦æŸæ—¶é—´å¤æ‚åº¦ä¸º O(n)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Main</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span>[] data1 = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125;;<br>        <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span>[] data2 = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>&#125;;<br><br>        System.out.println(getOnlyOnceStatus1(data1));<br>        System.out.println(getOnlyOnceStatus1(data2));<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é€šè¿‡setæ¥å­˜å‚¨ï¼Œæ¯”è¾ƒæ•°é‡</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> data æ•°ç»„</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> ç»“æœ</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">getOnlyOnceStatus1</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] data)</span> </span>&#123;<br><br>        Set&lt;Integer&gt; result = <span class="hljs-keyword">new</span> HashSet&lt;&gt;(data.length);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> datum : data) &#123;<br>            <span class="hljs-keyword">if</span> (!result.add(datum)) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">"NO"</span>;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (result.size() == data.length) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">"YES"</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">"NO"</span>;<br>    &#125;<br>&#125;<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">YES</span><br><span class="hljs-comment">NO</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure>

<h2 id="æ‰¾å‡ºæ•°ç»„ä¸­åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—ï¼Œå…¶å®ƒæ•°å­—éƒ½å‡ºç°äº†ä¸¤æ¬¡"><a href="#æ‰¾å‡ºæ•°ç»„ä¸­åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—ï¼Œå…¶å®ƒæ•°å­—éƒ½å‡ºç°äº†ä¸¤æ¬¡" class="headerlink" title="æ‰¾å‡ºæ•°ç»„ä¸­åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—ï¼Œå…¶å®ƒæ•°å­—éƒ½å‡ºç°äº†ä¸¤æ¬¡"></a>æ‰¾å‡ºæ•°ç»„ä¸­åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—ï¼Œå…¶å®ƒæ•°å­—éƒ½å‡ºç°äº†ä¸¤æ¬¡</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Main</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span>[] data1 = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>&#125;;<br>        <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span>[] data2 = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>&#125;;<br><br>        System.out.println(xorIntArray(data1));<br>        System.out.println(xorIntArray(data2));<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å¼‚æˆ–æ“ä½œ</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> data æ•°ç»„</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> ç»“æœ</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Integer <span class="hljs-title">xorIntArray</span><span class="hljs-params">(<span class="hljs-keyword">int</span>[] data)</span> </span>&#123;<br><br>        <span class="hljs-keyword">if</span> (data == <span class="hljs-keyword">null</span> || data.length == <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (data.length == <span class="hljs-number">1</span>) &#123;<br>            <span class="hljs-keyword">return</span> data[<span class="hljs-number">0</span>];<br>        &#125;<br>        <span class="hljs-keyword">int</span> result = data[<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; data.length; i++) &#123;<br>            result ^= data[i];<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br>&#125;<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">6</span><br><span class="hljs-comment">2</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://lyloou.github.io/%E7%AE%97%E6%B3%95/%E5%88%A4%E6%96%AD%E9%93%BE%E8%A1%A8%E6%98%AF%E5%90%A6%E6%9C%89%E7%8E%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/assets/images/avatar.png">
      <meta itemprop="name" content="lyloou">
      <meta itemprop="description" content="/* Better than last best */">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lyloou">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/%E7%AE%97%E6%B3%95/%E5%88%A4%E6%96%AD%E9%93%BE%E8%A1%A8%E6%98%AF%E5%90%A6%E6%9C%89%E7%8E%AF/" class="post-title-link" itemprop="url">ã€ç®—æ³•ã€‘åˆ¤æ–­é“¾è¡¨æ˜¯å¦æœ‰ç¯</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-06-02 14:23:28" itemprop="dateCreated datePublished" datetime="2021-06-02T14:23:28+08:00">2021-06-02</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * åˆ¤æ–­é“¾è¡¨æ˜¯å¦æœ‰ç¯</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> lilou</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 2021/6/2</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Ring</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span> </span>&#123;<br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Integer id;<br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String name;<br>        <span class="hljs-keyword">private</span> Node next;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Node</span><span class="hljs-params">(Integer id, String name)</span> </span>&#123;<br>            <span class="hljs-keyword">this</span>.id = id;<br>            <span class="hljs-keyword">this</span>.name = name;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> Integer <span class="hljs-title">getId</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> id;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> name;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> Node <span class="hljs-title">getNext</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> next;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setNext</span><span class="hljs-params">(Node next)</span> </span>&#123;<br>            <span class="hljs-keyword">this</span>.next = next;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-keyword">final</span> Node n1 = <span class="hljs-keyword">new</span> Node(<span class="hljs-number">1</span>, <span class="hljs-string">"èµµäº‘"</span>);<br>        <span class="hljs-keyword">final</span> Node n2 = <span class="hljs-keyword">new</span> Node(<span class="hljs-number">2</span>, <span class="hljs-string">"å…³ç¾½"</span>);<br>        <span class="hljs-keyword">final</span> Node n3 = <span class="hljs-keyword">new</span> Node(<span class="hljs-number">3</span>, <span class="hljs-string">"å¼ é£"</span>);<br>        <span class="hljs-keyword">final</span> Node n4 = <span class="hljs-keyword">new</span> Node(<span class="hljs-number">4</span>, <span class="hljs-string">"åˆ˜å¤‡"</span>);<br>        <span class="hljs-keyword">final</span> Node n5 = <span class="hljs-keyword">new</span> Node(<span class="hljs-number">5</span>, <span class="hljs-string">"æ›¹æ“"</span>);<br>        n1.setNext(n2);<br>        n2.setNext(n3);<br>        n3.setNext(n4);<br>        n4.setNext(n5);<br>        n5.setNext(n1);<br><br>        <span class="hljs-keyword">boolean</span> isRing = isRing2(n1);<br>        System.out.println(isRing);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ–¹æ³•1ï¼šå¿«æ…¢æŒ‡é’ˆ</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> n1 èŠ‚ç‚¹</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æ˜¯å¦æœ‰ç¯</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isRing</span><span class="hljs-params">(Node n1)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (n1 == <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        &#125;<br><br>        <span class="hljs-comment">// æ…¢æŒ‡é’ˆ</span><br>        Node slow = n1;<br>        <span class="hljs-comment">// å¿«æŒ‡é’ˆï¼Œä»ä¸‹ä¸€ä¸ªå¼€å§‹</span><br>        Node fast = n1.getNext();<br>        <span class="hljs-keyword">while</span> (fast != <span class="hljs-keyword">null</span> &amp;&amp; fast.getNext() != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">if</span> (fast == slow) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>            &#125;<br>            slow = slow.getNext();<br>            fast = fast.getNext().getNext();<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ–¹æ³•2ï¼š</span><br><span class="hljs-comment">     * 1ä¸ªæŒ‡é’ˆåŸåœ°ä¸åŠ¨ï¼Œ</span><br><span class="hljs-comment">     * 1ä¸ªæŒ‡é’ˆä¸€æ­¥ä¸€æ­¥å‘å‰æœç´¢</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> n1 èŠ‚ç‚¹</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æ˜¯å¦æœ‰ç¯</span><br><span class="hljs-comment">     */</span><br>       <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isRing2</span><span class="hljs-params">(Node n1)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (n1 == <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        &#125;<br>        <span class="hljs-comment">// åŸåœ°ä¸åŠ¨</span><br>        Node notMovePointer = n1;<br>        <span class="hljs-comment">// æ­¥é•¿ä¸º1ï¼Œå‘å‰æœç´¢</span><br>        Node forwardPointer = n1.getNext();<br>        <span class="hljs-keyword">while</span> (forwardPointer != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">if</span> (notMovePointer == forwardPointer) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>            &#125;<br>            forwardPointer = forwardPointer.getNext();<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://lyloou.github.io/mq/RocketMQ/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/assets/images/avatar.png">
      <meta itemprop="name" content="lyloou">
      <meta itemprop="description" content="/* Better than last best */">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lyloou">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/mq/RocketMQ/" class="post-title-link" itemprop="url">RocketMQ ç›¸å…³</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-05-31 11:19:15" itemprop="dateCreated datePublished" datetime="2021-05-31T11:19:15+08:00">2021-05-31</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="è½¯ä»¶ç¯å¢ƒ"><a href="#è½¯ä»¶ç¯å¢ƒ" class="headerlink" title="è½¯ä»¶ç¯å¢ƒ"></a>è½¯ä»¶ç¯å¢ƒ</h2><p>virtualbox: 6.1<br>centos: 7.0<br>jdk: 1.8<br>rocketmq: <a href="https://archive.apache.org/dist/rocketmq/4.5.1/rocketmq-all-4.5.1-bin-release.zip" target="_blank" rel="noopener">https://archive.apache.org/dist/rocketmq/4.5.1/rocketmq-all-4.5.1-bin-release.zip</a><br>rocketmq-console: <a href="https://github.com/apache/rocketmq-externals/tree/release-rocketmq-console-1.0.0" target="_blank" rel="noopener">https://github.com/apache/rocketmq-externals/tree/release-rocketmq-console-1.0.0</a></p>
<h2 id="å¯åŠ¨-RocketMQ"><a href="#å¯åŠ¨-RocketMQ" class="headerlink" title="å¯åŠ¨ RocketMQ"></a>å¯åŠ¨ RocketMQ</h2><p><strong>å¯åŠ¨ mq server</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">./mqnamesrv<br></code></pre></td></tr></table></figure>

<p><strong>å¯åŠ¨ broker</strong></p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">./mqbroker -n localhost:<span class="hljs-number">9876</span><br></code></pre></td></tr></table></figure>

<p><strong>ç¤ºä¾‹</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># é…ç½® namesrv åœ°å€ç¯å¢ƒ</span><br><span class="hljs-built_in">export</span> NAMESRV_ADDR=localhost:9876<br><span class="hljs-comment"># ç¤ºä¾‹ï¼šç”Ÿäº§</span><br>sh bin/tools.sh org.apache.rocketmq.example.quickstart.Producer<br><span class="hljs-comment"># ç¤ºä¾‹ï¼šæ¶ˆè´¹</span><br>sh bin/tools.sh org.apache.rocketmq.example.quickstart.Consumer<br></code></pre></td></tr></table></figure>

<p><strong>å¯åŠ¨æ§åˆ¶å°</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> /root/c/rocketmq-externals-rocketmq-console-1.0.0<br>mvn clean package -Dmaven.test.skip<br>java -jar /root/c/rocketmq-externals-rocketmq-console-1.0.0/rocketmq-console/target/rocketmq-console-ng-1.0.0.jar<br></code></pre></td></tr></table></figure>

<h2 id="åŸºäº-RocketMQ-åˆ†å¸ƒå¼äº‹åŠ¡"><a href="#åŸºäº-RocketMQ-åˆ†å¸ƒå¼äº‹åŠ¡" class="headerlink" title="åŸºäº RocketMQ åˆ†å¸ƒå¼äº‹åŠ¡"></a>åŸºäº RocketMQ åˆ†å¸ƒå¼äº‹åŠ¡</h2><p><img src="http://cdn.lyloou.com/img/RocketMQ-2021-06-15-11-33-52.png" alt="RocketMQ-2021-06-15-11-33-52"></p>
<blockquote>
<p>RocketMQ äº‹åŠ¡æ¶ˆæ¯çš„å®ç°åŸç†å°±æ˜¯åŸºäºä¸¤é˜¶æ®µæäº¤å’Œäº‹åŠ¡çŠ¶æ€å›æŸ¥ï¼Œæ¥å†³å®šæ¶ˆæ¯æœ€ç»ˆæ˜¯æäº¤è¿˜æ˜¯å›æ»šã€‚</p>
</blockquote>
<ul>
<li><a href="https://juejin.cn/post/6844904099993878536" target="_blank" rel="noopener">åŸºäº RocketMQ åˆ†å¸ƒå¼äº‹åŠ¡ - å®Œæ•´ç¤ºä¾‹</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://lyloou.github.io/%E7%AE%97%E6%B3%95/%E9%81%8D%E5%8E%86%E6%A0%B9%E5%88%B0%E6%89%80%E6%9C%89%E5%8F%B6%E5%AD%90%E8%8A%82%E7%82%B9%E7%9A%84%E8%B7%AF%E5%BE%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/assets/images/avatar.png">
      <meta itemprop="name" content="lyloou">
      <meta itemprop="description" content="/* Better than last best */">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lyloou">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/%E7%AE%97%E6%B3%95/%E9%81%8D%E5%8E%86%E6%A0%B9%E5%88%B0%E6%89%80%E6%9C%89%E5%8F%B6%E5%AD%90%E8%8A%82%E7%82%B9%E7%9A%84%E8%B7%AF%E5%BE%84/" class="post-title-link" itemprop="url">ã€ç®—æ³•ã€‘éå†æ ¹åˆ°æ‰€æœ‰å¶å­èŠ‚ç‚¹çš„è·¯å¾„</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-05-25 00:32:24" itemprop="dateCreated datePublished" datetime="2021-05-25T00:32:24+08:00">2021-05-25</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="éå†æ ¹åˆ°æ‰€æœ‰å¶å­èŠ‚ç‚¹çš„è·¯å¾„"><a href="#éå†æ ¹åˆ°æ‰€æœ‰å¶å­èŠ‚ç‚¹çš„è·¯å¾„" class="headerlink" title="éå†æ ¹åˆ°æ‰€æœ‰å¶å­èŠ‚ç‚¹çš„è·¯å¾„"></a>éå†æ ¹åˆ°æ‰€æœ‰å¶å­èŠ‚ç‚¹çš„è·¯å¾„</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.lyloou.tool.tree;<br><br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * **** ç¤ºä¾‹1 ****</span><br><span class="hljs-comment">         1</span><br><span class="hljs-comment">    2          3</span><br><span class="hljs-comment">  4   5      6   7</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"> è¾“å‡ºå¦‚ä¸‹ï¼š</span><br><span class="hljs-comment"> 1 2 4</span><br><span class="hljs-comment"> 1 2 5</span><br><span class="hljs-comment"> 1 3 6</span><br><span class="hljs-comment"> 1 3 7</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"></span><br><span class="hljs-comment"> * **** ç¤ºä¾‹2 ****</span><br><span class="hljs-comment">       1</span><br><span class="hljs-comment">  2        3</span><br><span class="hljs-comment">     5</span><br><span class="hljs-comment">  a = TreeNode(1)</span><br><span class="hljs-comment">  b = TreeNode(2)</span><br><span class="hljs-comment">  c = TreeNode(3)</span><br><span class="hljs-comment">  d = TreeNode(5)</span><br><span class="hljs-comment">  a.left = b</span><br><span class="hljs-comment">  a.right =  c</span><br><span class="hljs-comment">  b.right = d</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"> è¾“å‡ºå¦‚ä¸‹ï¼š</span><br><span class="hljs-comment"> ['1-&gt;2-&gt;5', '1-&gt;3']</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution2</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        test1();<br>        test2();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test1</span><span class="hljs-params">()</span> </span>&#123;<br>        TreeNode a = <span class="hljs-keyword">new</span> TreeNode(<span class="hljs-number">1</span>);<br>        TreeNode b = <span class="hljs-keyword">new</span> TreeNode(<span class="hljs-number">2</span>);<br>        TreeNode c = <span class="hljs-keyword">new</span> TreeNode(<span class="hljs-number">3</span>);<br>        TreeNode d = <span class="hljs-keyword">new</span> TreeNode(<span class="hljs-number">5</span>);<br>        a.left = b;<br>        a.right = c;<br>        b.right = d;<br>        System.out.println(binaryTreePaths(a));<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test2</span><span class="hljs-params">()</span> </span>&#123;<br>        TreeNode a1 = <span class="hljs-keyword">new</span> TreeNode(<span class="hljs-number">1</span>);<br>        TreeNode a2 = <span class="hljs-keyword">new</span> TreeNode(<span class="hljs-number">2</span>);<br>        TreeNode a3 = <span class="hljs-keyword">new</span> TreeNode(<span class="hljs-number">3</span>);<br>        TreeNode a4 = <span class="hljs-keyword">new</span> TreeNode(<span class="hljs-number">4</span>);<br>        TreeNode a5 = <span class="hljs-keyword">new</span> TreeNode(<span class="hljs-number">5</span>);<br>        TreeNode a6 = <span class="hljs-keyword">new</span> TreeNode(<span class="hljs-number">6</span>);<br>        TreeNode a7 = <span class="hljs-keyword">new</span> TreeNode(<span class="hljs-number">7</span>);<br>        a1.left = a2;<br>        a1.right = a3;<br>        a2.left = a4;<br>        a2.right = a5;<br>        a3.left = a6;<br>        a3.right = a7;<br>        System.out.println(binaryTreePaths(a1));<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> root the root of the binary tree</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> all root-to-leaf paths</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> List&lt;String&gt; <span class="hljs-title">binaryTreePaths</span><span class="hljs-params">(TreeNode root)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>        &#125;<br>        <span class="hljs-comment">// æœ‰å‡ ä¸ªå¶å­èŠ‚ç‚¹ï¼Œå°±æœ‰å‡ æ¡è·¯å¾„</span><br>        <span class="hljs-keyword">if</span> (isLeaf(root)) &#123;<br>            List&lt;String&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>            list.add(root.val + <span class="hljs-string">""</span>);<br>            <span class="hljs-keyword">return</span> list;<br>        &#125;<br><br>        <span class="hljs-comment">// è·å–å·¦å­æ ‘çš„åˆ—è¡¨ï¼Œå¾ªç¯å‘å…ƒç´ å‰é¢è¿½åŠ å½“å‰å€¼</span><br>        <span class="hljs-keyword">final</span> List&lt;String&gt; leftList = binaryTreePaths(root.left);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; leftList.size(); i++) &#123;<br>            leftList.set(i, root.val + <span class="hljs-string">"-&gt;"</span> + leftList.get(i));<br>        &#125;<br><br>        <span class="hljs-comment">// è·å–å³å­æ ‘çš„åˆ—è¡¨ï¼Œå¾ªç¯å‘å…ƒç´ å‰é¢è¿½åŠ å½“å‰å€¼</span><br>        <span class="hljs-keyword">final</span> List&lt;String&gt; rightList = binaryTreePaths(root.right);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rightList.size(); i++) &#123;<br>            rightList.set(i, root.val + <span class="hljs-string">"-&gt;"</span> + rightList.get(i));<br>        &#125;<br><br>        <span class="hljs-comment">// æ‹¼æ¥æˆä¸€ä¸ªåˆ—è¡¨è¿”å›</span><br>        List&lt;String&gt; result = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;(leftList.size() + rightList.size());<br>        result.addAll(leftList);<br>        result.addAll(rightList);<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆ¤æ–­nodeæ˜¯å¦ä¸ºå¶å­èŠ‚ç‚¹</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> node èŠ‚ç‚¹</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> true ä¸ºå¶å­èŠ‚ç‚¹ï¼Œ</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isLeaf</span><span class="hljs-params">(TreeNode node)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> node.left == <span class="hljs-keyword">null</span> &amp;&amp; node.right == <span class="hljs-keyword">null</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TreeNode</span> </span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> val;<br>        <span class="hljs-keyword">public</span> TreeNode left, right;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">TreeNode</span><span class="hljs-params">(<span class="hljs-keyword">int</span> val)</span> </span>&#123;<br>            <span class="hljs-keyword">this</span>.val = val;<br>            <span class="hljs-keyword">this</span>.left = <span class="hljs-keyword">this</span>.right = <span class="hljs-keyword">null</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="è¿è¡Œç»“æœ"><a href="#è¿è¡Œç»“æœ" class="headerlink" title="è¿è¡Œç»“æœ"></a>è¿è¡Œç»“æœ</h2><p><img src="http://cdn.lyloou.com/img/all-to-leaf-path-2021-05-25-00-35-39.png" alt="all-to-leaf-path-2021-05-25-00-35-39"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://lyloou.github.io/java/maven-command/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/assets/images/avatar.png">
      <meta itemprop="name" content="lyloou">
      <meta itemprop="description" content="/* Better than last best */">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lyloou">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/java/maven-command/" class="post-title-link" itemprop="url">Mavenå‘½ä»¤</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-05-18 10:16:44" itemprop="dateCreated datePublished" datetime="2021-05-18T10:16:44+08:00">2021-05-18</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="maven-ä¿®æ”¹ç‰ˆæœ¬å·å‘½ä»¤"><a href="#maven-ä¿®æ”¹ç‰ˆæœ¬å·å‘½ä»¤" class="headerlink" title="maven ä¿®æ”¹ç‰ˆæœ¬å·å‘½ä»¤"></a>maven ä¿®æ”¹ç‰ˆæœ¬å·å‘½ä»¤</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># æ›´æ–°æ ¹æ¨¡å—åŠæ‰€æœ‰å­æ¨¡å—çš„ç‰ˆæœ¬å·ï¼ŒåŒæ—¶ä¼šç”Ÿæˆ pom.xml.versionsBackup æ–‡ä»¶</span><br>mvn versions:<span class="hljs-built_in">set</span> -DnewVersion=x.x.x-SNAPSHOT<br><br><span class="hljs-comment"># æäº¤ç‰ˆæœ¬ä¿®æ”¹ åŒæ—¶ä¼šåˆ é™¤ pom.xml.versionsBackup æ–‡ä»¶ã€‚</span><br>mvn versions:commit<br></code></pre></td></tr></table></figure>

<p>ref:</p>
<blockquote>
<ul>
<li><a href="https://www.liujiajia.me/2018/11/29/maven-set-modules-version" target="_blank" rel="noopener">ã€Mavenã€‘ä¿®æ”¹æ¨¡å—ç‰ˆæœ¬å· | ä½³ä½³çš„åšå®¢</a></li>
<li><a href="https://github.com/alibaba/jetcache/wiki/DevNote_CN" target="_blank" rel="noopener">DevNote_CN Â· alibaba/jetcache Wiki</a></li>
<li><a href="https://blog.csdn.net/ggbomb2/article/details/78316068" target="_blank" rel="noopener">Versions maven plugin ä¿®æ”¹ç‰ˆæœ¬_GGBomb2 çš„åšå®¢-CSDN åšå®¢</a></li>
</ul>
</blockquote>
<h2 id="å¤šä¸ª-maven-æ¨¡å—çš„é¡¹ç›®ï¼Œåªæ‰“åŒ…æŸä¸ªæ¨¡å—å’Œå…¶å…³è”çš„æ¨¡å—"><a href="#å¤šä¸ª-maven-æ¨¡å—çš„é¡¹ç›®ï¼Œåªæ‰“åŒ…æŸä¸ªæ¨¡å—å’Œå…¶å…³è”çš„æ¨¡å—" class="headerlink" title="å¤šä¸ª maven æ¨¡å—çš„é¡¹ç›®ï¼Œåªæ‰“åŒ…æŸä¸ªæ¨¡å—å’Œå…¶å…³è”çš„æ¨¡å—"></a>å¤šä¸ª maven æ¨¡å—çš„é¡¹ç›®ï¼Œåªæ‰“åŒ…æŸä¸ªæ¨¡å—å’Œå…¶å…³è”çš„æ¨¡å—</h2><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/fqwgc8/article/details/50517821" target="_blank" rel="noopener">Maven å¤šä¸ª mudule åªç¼–è¯‘ã€æ‰“åŒ…æŒ‡å®š module_fqwgc8 çš„åšå®¢-CSDN åšå®¢_maven ç¼–è¯‘æŒ‡å®š module</a></p>
<p>ä¾‹å¦‚ A,B,P çš„ç»§æ‰¿å…³ç³»ä¸º<br>P<br>|<br>â€”â€“ A<br>|<br>â€”â€“ B</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs applescript">-pl, <span class="hljs-comment">--projects</span><br>        Build specified reactor projects <span class="hljs-keyword">instead of</span> all projects<br>-am, <span class="hljs-comment">--also-make</span><br>        If project <span class="hljs-built_in">list</span> <span class="hljs-keyword">is</span> specified, also build projects required <span class="hljs-keyword">by</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">list</span><br></code></pre></td></tr></table></figure>

<p>æ‰“åŒ… A</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># è¿›å…¥ç›®å½• P</span><br>mvn install -pl A -am<br><span class="hljs-comment"># æ·»åŠ prodå‚æ•°</span><br>mvn install -pl A -am -Pprod<br>mvn package -pl A -am -Pprod<br></code></pre></td></tr></table></figure>

<h2 id="maven-å¤šæ¨¡å—"><a href="#maven-å¤šæ¨¡å—" class="headerlink" title="maven å¤šæ¨¡å—"></a>maven å¤šæ¨¡å—</h2><ul>
<li><a href="https://juejin.im/post/5cd15ed2e51d453b5854b881" target="_blank" rel="noopener">ä¸‰åˆ†é’ŸæŠŠ spring boot æ‰“æˆ war åŒ…éƒ¨ç½²åˆ° tomcat ä¸­ - æ˜é‡‘</a></li>
<li>æ‰“åŒ…å…±äº« lib ï¼Œåˆ†ç¦»é…ç½®æ–‡ä»¶</li>
</ul>
<h2 id="æ¨¡å—å¤ªå¤šï¼Œç¼–è¯‘æŒ‡å®šæ¨¡å—"><a href="#æ¨¡å—å¤ªå¤šï¼Œç¼–è¯‘æŒ‡å®šæ¨¡å—" class="headerlink" title="æ¨¡å—å¤ªå¤šï¼Œç¼–è¯‘æŒ‡å®šæ¨¡å—"></a>æ¨¡å—å¤ªå¤šï¼Œç¼–è¯‘æŒ‡å®šæ¨¡å—</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-comment"># ç¼–è¯‘æŒ‡å®šmodule</span><br><span class="hljs-comment"># [continuous integration - Skip a submodule during a Maven build - Stack Overflow](https://stackoverflow.com/questions/8304110/skip-a-submodule-during-a-maven-build)</span><br><br>mvn -pl \<br>:marketing-api-tv-topic-pk,\<br>:marketing-api-phone-topic-pk\<br>  clean install -Dmaven.skip.test=<span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure>

<h2 id="æŸ¥çœ‹åŒ…ä¾èµ–æƒ…å†µï¼Œä»ä»€ä¹ˆæ—¶å€™å¼•å…¥çš„"><a href="#æŸ¥çœ‹åŒ…ä¾èµ–æƒ…å†µï¼Œä»ä»€ä¹ˆæ—¶å€™å¼•å…¥çš„" class="headerlink" title="æŸ¥çœ‹åŒ…ä¾èµ–æƒ…å†µï¼Œä»ä»€ä¹ˆæ—¶å€™å¼•å…¥çš„"></a>æŸ¥çœ‹åŒ…ä¾èµ–æƒ…å†µï¼Œä»ä»€ä¹ˆæ—¶å€™å¼•å…¥çš„</h2><p><a href="https://www.cnblogs.com/wormday/p/8186109.html" target="_blank" rel="noopener">é€šè¿‡ IntelliJ IDEA å’Œ Maven å‘½ä»¤æŸ¥çœ‹æŸä¸ª jar åŒ…æ˜¯æ€ä¹ˆå¼•å…¥çš„ - å°å¢¨çš„ç«¥é‹ - åšå®¢å›­</a></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs groovy">mvn <span class="hljs-string">dependency:</span>tree -Dverbose -Dincludes=org.<span class="hljs-string">yaml:</span>snakeyaml<br></code></pre></td></tr></table></figure>

<h2 id="æ‰“åŒ…æ—¶è·³è¿‡æµ‹è¯•"><a href="#æ‰“åŒ…æ—¶è·³è¿‡æµ‹è¯•" class="headerlink" title="æ‰“åŒ…æ—¶è·³è¿‡æµ‹è¯•"></a>æ‰“åŒ…æ—¶è·³è¿‡æµ‹è¯•</h2><p>æ³¨æ„ç”¨çš„æ˜¯ package å‘½ä»¤ è€Œä¸æ˜¯ war å‘½ä»¤</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">mvn clean package -<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Dmaven</span>.</span></span>test.skip=<span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://lyloou.github.io/java/java8_%E5%A6%82%E4%BD%95%E4%BB%A5%E5%B9%B6%E5%8F%91%E6%96%B9%E5%BC%8F%E5%9C%A8%E5%90%8C%E4%B8%80%E4%B8%AA%E6%B5%81%E4%B8%8A%E6%89%A7%E8%A1%8C%E5%A4%9A%E7%A7%8D%E6%93%8D%E4%BD%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/assets/images/avatar.png">
      <meta itemprop="name" content="lyloou">
      <meta itemprop="description" content="/* Better than last best */">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lyloou">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/java/java8_%E5%A6%82%E4%BD%95%E4%BB%A5%E5%B9%B6%E5%8F%91%E6%96%B9%E5%BC%8F%E5%9C%A8%E5%90%8C%E4%B8%80%E4%B8%AA%E6%B5%81%E4%B8%8A%E6%89%A7%E8%A1%8C%E5%A4%9A%E7%A7%8D%E6%93%8D%E4%BD%9C/" class="post-title-link" itemprop="url">Java8_å¦‚ä½•ä»¥å¹¶å‘æ–¹å¼åœ¨åŒä¸€ä¸ªæµä¸Šæ‰§è¡Œå¤šç§æ“ä½œ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-05-07 11:55:46" itemprop="dateCreated datePublished" datetime="2021-05-07T11:55:46+08:00">2021-05-07</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>java8 ä¸­ï¼Œstream æµå¤šæ¬¡ä½¿ç”¨ä¼šæŠ›å‡ºå¼‚å¸¸ï¼šjava.lang.IllegalStateException: stream has already been operated upon or closed</p>
<p>æ‰€ä»¥å¦‚ä½•è§£å†³å‘¢â€”â€”å¦‚ä½•ä»¥å¹¶å‘æ–¹å¼åœ¨åŒä¸€ä¸ªæµä¸Šæ‰§è¡Œå¤šç§æ“ä½œ</p>
<p>å¯ä»¥ å€ŸåŠ© Spliteratorï¼Œå°¤å…¶æ˜¯å®ƒçš„å»¶è¿Ÿç»‘å®šèƒ½åŠ›ï¼Œç»“åˆ BlockingQueues å’Œ Futures æ¥å®ç°è¿™ä¸€å¤§æœ‰è£¨ç›Šçš„ç‰¹æ€§</p>
<h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">import</span> java.util.*;<br><span class="hljs-keyword">import</span> java.util.concurrent.BlockingQueue;<br><span class="hljs-keyword">import</span> java.util.concurrent.CompletableFuture;<br><span class="hljs-keyword">import</span> java.util.concurrent.Future;<br><span class="hljs-keyword">import</span> java.util.concurrent.LinkedBlockingQueue;<br><span class="hljs-keyword">import</span> java.util.function.Consumer;<br><span class="hljs-keyword">import</span> java.util.function.Function;<br><span class="hljs-keyword">import</span> java.util.stream.Stream;<br><span class="hljs-keyword">import</span> java.util.stream.StreamSupport;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å¦‚ä½•ä»¥å¹¶å‘æ–¹å¼åœ¨åŒä¸€ä¸ªæµä¸Šæ‰§è¡Œå¤šç§æ“ä½œ</span><br><span class="hljs-comment"> * å‚è€ƒï¼šjava8_in_action é™„å½•C</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> lilou</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 2021/5/7</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StreamForker</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Stream&lt;T&gt; stream;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;Object, Function&lt;Stream&lt;T&gt;, ?&gt;&gt; forks = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">StreamForker</span><span class="hljs-params">(Stream&lt;T&gt; stream)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.stream = stream;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> StreamForker&lt;T&gt; <span class="hljs-title">fork</span><span class="hljs-params">(Object key, Function&lt;Stream&lt;T&gt;, ?&gt; f)</span> </span>&#123;<br>        forks.put(key, f);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Results <span class="hljs-title">getResults</span><span class="hljs-params">()</span> </span>&#123;<br>        ForkingStreamConsumer&lt;T&gt; consumer = build();<br>        <span class="hljs-keyword">try</span> &#123;<br>            stream.sequential().forEach(consumer);<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            consumer.finish();<br>        &#125;<br>        <span class="hljs-keyword">return</span> consumer;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> ForkingStreamConsumer&lt;T&gt; <span class="hljs-title">build</span><span class="hljs-params">()</span> </span>&#123;<br>        List&lt;BlockingQueue&lt;T&gt;&gt; queues = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>        Map&lt;Object, Future&lt;?&gt;&gt; actions = forks.entrySet()<br>                .stream()<br>                .reduce(<br>                        <span class="hljs-keyword">new</span> HashMap&lt;Object, Future&lt;?&gt;&gt;(),<br>                        (map, e) -&gt; &#123;<br>                            map.put(e.getKey(), getOperationResult(queues, e.getValue()));<br>                            <span class="hljs-keyword">return</span> map;<br>                        &#125;,<br>                        (m1, m2) -&gt; &#123;<br>                            m1.putAll(m2);<br>                            <span class="hljs-keyword">return</span> m1;<br>                        &#125;<br>                );<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ForkingStreamConsumer&lt;&gt;(queues, actions);<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> Future&lt;?&gt; getOperationResult(List&lt;BlockingQueue&lt;T&gt;&gt; queues, Function&lt;Stream&lt;T&gt;, ?&gt; f) &#123;<br>        BlockingQueue&lt;T&gt; queue = <span class="hljs-keyword">new</span> LinkedBlockingQueue&lt;&gt;();<br>        queues.add(queue);<br>        <span class="hljs-keyword">final</span> Spliterator&lt;T&gt; spliterator = <span class="hljs-keyword">new</span> BlockingQueueSpliterator&lt;&gt;(queue);<br>        <span class="hljs-keyword">final</span> Stream&lt;T&gt; source = StreamSupport.stream(spliterator, <span class="hljs-keyword">false</span>);<br>        <span class="hljs-keyword">return</span> CompletableFuture.supplyAsync(() -&gt; f.apply(source));<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Results</span> </span>&#123;<br><br>        <span class="hljs-keyword">public</span> &lt;R&gt; <span class="hljs-function">R <span class="hljs-title">get</span><span class="hljs-params">(Object key)</span></span>;<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ForkingStreamConsumer</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title">Consumer</span>&lt;<span class="hljs-title">T</span>&gt;, <span class="hljs-title">Results</span> </span>&#123;<br>        <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Object END_OF_STREAM = <span class="hljs-keyword">new</span> Object();<br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;BlockingQueue&lt;T&gt;&gt; queues;<br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;Object, Future&lt;?&gt;&gt; actions;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ForkingStreamConsumer</span><span class="hljs-params">(List&lt;BlockingQueue&lt;T&gt;&gt; queues, Map&lt;Object, Future&lt;?&gt;&gt; actions)</span> </span>&#123;<br>            <span class="hljs-keyword">this</span>.queues = queues;<br>            <span class="hljs-keyword">this</span>.actions = actions;<br>        &#125;<br><br>        <span class="hljs-meta">@SuppressWarnings</span>(&#123;<span class="hljs-string">"unchecked"</span>, <span class="hljs-string">"SSBasedInspection"</span>&#125;)<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> &lt;R&gt; <span class="hljs-function">R <span class="hljs-title">get</span><span class="hljs-params">(Object key)</span> </span>&#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-keyword">return</span> ((Future&lt;R&gt;) actions.get(key)).get();<br>            &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(e);<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">accept</span><span class="hljs-params">(T t)</span> </span>&#123;<br>            queues.forEach(q -&gt; q.add(t));<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">finish</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-comment">//noinspection unchecked</span><br>            accept((T) END_OF_STREAM);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BlockingQueueSpliterator</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title">Spliterator</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> BlockingQueue&lt;T&gt; q;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">BlockingQueueSpliterator</span><span class="hljs-params">(BlockingQueue&lt;T&gt; q)</span> </span>&#123;<br>            <span class="hljs-keyword">this</span>.q = q;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">tryAdvance</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-keyword">super</span> T&gt; action)</span> </span>&#123;<br>            T t;<br>            <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) &#123;<br>                <span class="hljs-comment">//noinspection SSBasedInspection</span><br>                <span class="hljs-keyword">try</span> &#123;<br>                    t = q.take();<br>                    <span class="hljs-keyword">break</span>;<br>                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    e.printStackTrace();<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">if</span> (t != ForkingStreamConsumer.END_OF_STREAM) &#123;<br>                action.accept(t);<br>                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> Spliterator&lt;T&gt; <span class="hljs-title">trySplit</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">long</span> <span class="hljs-title">estimateSize</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">characteristics</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><br><span class="hljs-keyword">import</span> java.util.Arrays;<br><span class="hljs-keyword">import</span> java.util.stream.Collectors;<br><span class="hljs-keyword">import</span> java.util.stream.Stream;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> lilou</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 2021/5/7</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StreamForkerTest</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-keyword">int</span>[] a = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">100</span>];<br>        Arrays.fill(a, <span class="hljs-number">1</span>);<br>        Arrays.parallelPrefix(a, Integer::sum);<br><br>        <span class="hljs-keyword">final</span> Stream&lt;Integer&gt; integerStream = Arrays.stream(a).boxed();<br>        <span class="hljs-keyword">final</span> StreamForker.Results results = <span class="hljs-keyword">new</span> StreamForker&lt;&gt;(integerStream)<br>                .fork(<span class="hljs-string">"å¹³å‡å€¼"</span>, StreamForkerTest::average)<br>                .fork(<span class="hljs-string">"æ±‚å’Œ"</span>, StreamForkerTest::sum)<br>                .fork(<span class="hljs-string">"æ‹¼æ¥"</span>, StreamForkerTest::concat)<br>                .getResults();<br><br>        String average = results.get(<span class="hljs-string">"å¹³å‡å€¼"</span>);<br>        String sum = results.get(<span class="hljs-string">"æ±‚å’Œ"</span>);<br>        String concat = results.get(<span class="hljs-string">"æ‹¼æ¥"</span>);<br><br>        System.out.println(<span class="hljs-string">"å¹³å‡å€¼:"</span> + average);<br>        System.out.println(<span class="hljs-string">"æ±‚å’Œ:"</span> + sum);<br>        System.out.println(<span class="hljs-string">"æ‹¼æ¥:"</span> + concat);<br><br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">concat</span><span class="hljs-params">(Stream&lt;Integer&gt; stream)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> stream.map(String::valueOf).collect(Collectors.joining(<span class="hljs-string">","</span>));<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">sum</span><span class="hljs-params">(Stream&lt;Integer&gt; stream)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> stream.reduce(Integer::sum).map(String::valueOf).orElse(<span class="hljs-string">""</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">average</span><span class="hljs-params">(Stream&lt;Integer&gt; stream)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> stream.mapToInt(Integer::intValue).summaryStatistics().getAverage() + <span class="hljs-string">""</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>ç»“æœ</strong></p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">å¹³å‡å€¼:<span class="hljs-number">50.5</span><br>æ±‚å’Œ:<span class="hljs-number">5050</span><br>æ‹¼æ¥:<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>,<span class="hljs-number">17</span>,<span class="hljs-number">18</span>,<span class="hljs-number">19</span>,<span class="hljs-number">20</span>,<span class="hljs-number">21</span>,<span class="hljs-number">22</span>,<span class="hljs-number">23</span>,<span class="hljs-number">24</span>,<span class="hljs-number">25</span>,<span class="hljs-number">26</span>,<span class="hljs-number">27</span>,<span class="hljs-number">28</span>,<span class="hljs-number">29</span>,<span class="hljs-number">30</span>,<span class="hljs-number">31</span>,<span class="hljs-number">32</span>,<span class="hljs-number">33</span>,<span class="hljs-number">34</span>,<span class="hljs-number">35</span>,<span class="hljs-number">36</span>,<span class="hljs-number">37</span>,<span class="hljs-number">38</span>,<span class="hljs-number">39</span>,<span class="hljs-number">40</span>,<span class="hljs-number">41</span>,<span class="hljs-number">42</span>,<span class="hljs-number">43</span>,<span class="hljs-number">44</span>,<span class="hljs-number">45</span>,<span class="hljs-number">46</span>,<span class="hljs-number">47</span>,<span class="hljs-number">48</span>,<span class="hljs-number">49</span>,<span class="hljs-number">50</span>,<span class="hljs-number">51</span>,<span class="hljs-number">52</span>,<span class="hljs-number">53</span>,<span class="hljs-number">54</span>,<span class="hljs-number">55</span>,<span class="hljs-number">56</span>,<span class="hljs-number">57</span>,<span class="hljs-number">58</span>,<span class="hljs-number">59</span>,<span class="hljs-number">60</span>,<span class="hljs-number">61</span>,<span class="hljs-number">62</span>,<span class="hljs-number">63</span>,<span class="hljs-number">64</span>,<span class="hljs-number">65</span>,<span class="hljs-number">66</span>,<span class="hljs-number">67</span>,<span class="hljs-number">68</span>,<span class="hljs-number">69</span>,<span class="hljs-number">70</span>,<span class="hljs-number">71</span>,<span class="hljs-number">72</span>,<span class="hljs-number">73</span>,<span class="hljs-number">74</span>,<span class="hljs-number">75</span>,<span class="hljs-number">76</span>,<span class="hljs-number">77</span>,<span class="hljs-number">78</span>,<span class="hljs-number">79</span>,<span class="hljs-number">80</span>,<span class="hljs-number">81</span>,<span class="hljs-number">82</span>,<span class="hljs-number">83</span>,<span class="hljs-number">84</span>,<span class="hljs-number">85</span>,<span class="hljs-number">86</span>,<span class="hljs-number">87</span>,<span class="hljs-number">88</span>,<span class="hljs-number">89</span>,<span class="hljs-number">90</span>,<span class="hljs-number">91</span>,<span class="hljs-number">92</span>,<span class="hljs-number">93</span>,<span class="hljs-number">94</span>,<span class="hljs-number">95</span>,<span class="hljs-number">96</span>,<span class="hljs-number">97</span>,<span class="hljs-number">98</span>,<span class="hljs-number">99</span>,<span class="hljs-number">100</span><br></code></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://lyloou.github.io/linux/centos/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/assets/images/avatar.png">
      <meta itemprop="name" content="lyloou">
      <meta itemprop="description" content="/* Better than last best */">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lyloou">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/linux/centos/" class="post-title-link" itemprop="url">Centos ç›¸å…³</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-04-25 17:33:11" itemprop="dateCreated datePublished" datetime="2021-04-25T17:33:11+08:00">2021-04-25</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="è®¾ç½®ä¸»æœºåç§°"><a href="#è®¾ç½®ä¸»æœºåç§°" class="headerlink" title="è®¾ç½®ä¸»æœºåç§°"></a>è®¾ç½®ä¸»æœºåç§°</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># è®¾ç½®ä¸»æœºå</span><br>hostnamectl <span class="hljs-built_in">set</span>-hostname yourhostname<br><span class="hljs-comment"># åˆ·æ–°ç”Ÿæ•ˆ</span><br>bash<br></code></pre></td></tr></table></figure>

<p><strong>æŸ¥çœ‹ç‰ˆæœ¬</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">cat /etc/redhat-release<br>uname -a<br>uname -r<br></code></pre></td></tr></table></figure>

<h2 id="é…ç½®å›ºå®š-ip"><a href="#é…ç½®å›ºå®š-ip" class="headerlink" title="é…ç½®å›ºå®š ip"></a>é…ç½®å›ºå®š ip</h2><p>ç¼–è¾‘ï¼š<code>vi /etc/sysconfig/network-scripts/ifcfg-ens0s8</code><br>(æ³¨æ„ï¼šens0s8 è¿™ä¸ªåå­—è¦å’Œ <code>ip addr</code>ä¸­çš„åå­—ä¿æŒä¸€è‡´ï¼Œå¦‚æœä¸ä¸€æ ·ä¿®æ”¹æ–‡ä»¶åå³å¯ï¼Œå¦åˆ™ä¼šé‡å¯å¤±è´¥)</p>
<p><strong>é»˜è®¤</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs sh">TYPE=Ethernet<br>BOOTPROTO=dhcp<br>DEFROUTE=yes<br>PEERDNS=yes<br>PEERROUTES=yes<br>IPV4_FAILURE_FATAL=no<br>IPV6INIT=yes<br>IPV6_AUTOCONF=yes<br>IPV6_DEFROUTE=yes<br>IPV6_PEERDNS=yes<br>IPV6_PEERROUTES=yes<br>IPV6_FAILURE_FATAL=no<br>NAME=enp0s8<br>UUID=ed6c068c-149c-4678-8a13-d6e34a5d50c9<br>DEVICE=enp0s8<br>ONBOOT=yes<br>DNS1=10.0.2.2<br>DNS2=8.8.8.8<br></code></pre></td></tr></table></figure>

<p><strong>è‡ªå®šä¹‰</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs sh">TYPE=Ethernet<br>BOOTPROTO=none<br>DEFROUTE=yes<br>PEERDNS=yes<br>PEERROUTES=yes<br>IPV4_FAILURE_FATAL=no<br>IPV6INIT=yes<br>IPV6_AUTOCONF=yes<br>IPV6_DEFROUTE=yes<br>IPV6_PEERDNS=yes<br>IPV6_PEERROUTES=yes<br>IPV6_FAILURE_FATAL=no<br>NAME=enp0s8<br>UUID=ed6c068c-149c-4678-8a13-d6e34a5d50c9<br>DEVICE=enp0s8<br>ONBOOT=yes<br>IPADDR=172.20.130.84<br>GATEWAY=172.20.130.1<br>DNS1=10.0.2.2<br>DNS2=8.8.8.8<br></code></pre></td></tr></table></figure>

<p>é‡å¯ï¼š <code>systemctl restart network</code></p>
<h2 id="å…³é—­é˜²ç«å¢™"><a href="#å…³é—­é˜²ç«å¢™" class="headerlink" title="å…³é—­é˜²ç«å¢™"></a>å…³é—­é˜²ç«å¢™</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">systemctl status firewalld<br>systemctl stop firewalld<br>systemctl <span class="hljs-built_in">disable</span> firewalld<br></code></pre></td></tr></table></figure>

<h2 id="å…å¯†ç™»å½•"><a href="#å…å¯†ç™»å½•" class="headerlink" title="å…å¯†ç™»å½•"></a>å…å¯†ç™»å½•</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">ssh-copy-id -i ~/.ssh/id_rsa.pub root@172.20.130.84<br></code></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="ä¸Šä¸€é¡µ"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/32/">32</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="ä¸‹ä¸€é¡µ"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="lyloou"
      src="/assets/images/avatar.png">
  <p class="site-author-name" itemprop="name">lyloou</p>
  <div class="site-description" itemprop="description">/* Better than last best */</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">313</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">56</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/lyloou" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;lyloou" rel="noopener" target="_blank">GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:lyloou6@gmail.com" title="E-Mail â†’ mailto:lyloou6@gmail.com" rel="noopener" target="_blank">E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/lyloou" title="Weibo â†’ https:&#x2F;&#x2F;weibo.com&#x2F;lyloou" rel="noopener" target="_blank">Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/ly1414725328" title="CSDN â†’ https:&#x2F;&#x2F;blog.csdn.net&#x2F;ly1414725328" rel="noopener" target="_blank">CSDN</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">ç²¤ICPå¤‡18151128å· </a>
  </div>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">lyloou</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> å¼ºåŠ›é©±åŠ¨
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>

<script src="/js/utils.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>











<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

  


</body>
</html>
